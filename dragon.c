#include <stdio.h> // эСЬьдА ьЮЕь╢Ьыае ыЭ╝ьЭ┤ы╕МыЯмыжм (printf, scanf ыУ▒)
#include <stdlib.h> // эСЬьдА ьЬаэЛ╕ыжмэЛ░ ыЭ╝ьЭ┤ы╕МыЯмыжм (rand, srand, malloc, free, atoi ыУ▒)
#include <unistd.h> // POSIX ьЪ┤ьШБь▓┤ьаЬ API (usleep ыУ▒ ьЛЬъ░Д ьзАьЧ░ эХиьИШ)
#include <termios.h> // эД░ып╕ыДР I/O ьДдьаХ (ьШИ: ьжЙьЛЬ эВд ьЮЕыае ь▓Шыжмые╝ ьЬДэХЬ raw ыкиыУЬ)
#include <string.h> // ым╕ьЮРьЧ┤ ьб░ьЮС эХиьИШ (memcpy, strcmp ыУ▒)
#include <time.h> // ьЛЬъ░Д ъ┤Аыаи эХиьИШ (эК╣эЮИ rand() ьЛЬыУЬ ьДдьаХьЪй)
#include <fcntl.h> // эММьЭ╝ ьаЬьЦ┤ ьШ╡ьЕШ (ьЧмъ╕░ьДЬыКФ ы╣Ды╕ФыбЬэВ╣ ьЮЕыаеьЪй)
#include <stdbool.h> // ы╢ИыжмьЦ╕ эГАьЮЕ (true/false) ьВмьЪйьЭД ьЬДэХЬ эЧдыНФ

// ыз╡ эБмъ╕░ ьаХьЭШ
#define ROW 20 // ъ▓МьЮД ыз╡ьЭШ эЦЙ(ьД╕ыбЬ) ъ░ЬьИШ
#define COL 40 // ъ▓МьЮД ыз╡ьЭШ ьЧ┤(ъ░АыбЬ) ъ░ЬьИШ
#define MAX_FIREBALLS 20 // ыПЩьЛЬьЧР ьб┤ьЮмэХа ьИШ ьЮИыКФ эММьЭ┤ьЦ┤ы│╝/эГДэЩШьЭШ ь╡ЬыМА ъ░ЬьИШ
#define MAX_MONSTERS 20 // ыПЩьЛЬьЧР ьб┤ьЮмэХа ьИШ ьЮИыКФ ыкмьКдэД░ьЭШ ь╡ЬыМА ъ░ЬьИШ
#define MONSTER_MOVE_DELAY 50 // ыкмьКдэД░ ьЭ┤ыПЩ ьг╝ъ╕░ (эФДыаИьЮД ыЛиьЬД)
#define MONSTER_SHOOT_DELAY 50 // ыкмьКдэД░ эГДэЩШ ы░ЬьВм ьг╝ъ╕░ (эФДыаИьЮД ыЛиьЬД)
#define MONSTER_BULLET_MOVE_DELAY 3 // ыкмьКдэД░ эГДэЩШ ьЭ┤ыПЩ ьЖНыПД ьаЬьЦ┤ (эБ┤ьИШыбЭ ыКРыадьзР)
#define MONSTER_RESPAWN_DELAY 300 // ьг╜ьЭА ыкмьКдэД░ъ░А ыЛдьЛЬ ыВШэГАыВШъ╕░ъ╣МьзАьЭШ ьзАьЧ░ ьЛЬъ░Д (эФДыаИьЮД ыЛиьЬД)

// эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш ьаДьЧн ы│АьИШ
int playerX = 1, playerY = 18; // эФМыаИьЭ┤ьЦ┤ьЭШ ь┤Иъ╕░ X, Y ьвМэСЬ

// ыУЬыЮШъ│д ы╕МыаИьКд ьаДьЧн ы│АьИШ (ьКдэВм ы░йэЦе ьДдьаХьЪй)
int dirX = 1; // ыУЬыЮШъ│д ы╕МыаИьКдьЭШ X ы░йэЦе (ь┤Иъ╕░ъ░Т: ьШдые╕ьк╜)
int dirY = 0; // ыУЬыЮШъ│д ы╕МыаИьКдьЭШ Y ы░йэЦе (ь┤Иъ╕░ъ░Т: ьИШьзБ ьЭ┤ыПЩ ьЧЖьЭМ)

// ыкмьКдэД░ ыжмьаа(ьЮмьГЭьД▒) ьаДьЧн ы│АьИШ
int monsterRespawnTimer[MAX_MONSTERS] = {0}; // ъ░Б ыкмьКдэД░ьЭШ ыжмьаа эГАьЭ┤ыи╕
int monsterOriginX[MAX_MONSTERS]; // ыкмьКдэД░ ыжмьаа ьЛЬ ьЫРыЮШ X ьЬДь╣Ш ьаАьЮе
int monsterOriginY[MAX_MONSTERS]; // ыкмьКдэД░ ыжмьаа ьЛЬ ьЫРыЮШ Y ьЬДь╣Ш ьаАьЮе

// эАШьКдэК╕ ьаДьЧн ы│АьИШ
int queststop = 0; // эАШьКдэК╕ ьЩДыгМ ыйФьЛЬьзА ь╢ЬыаеьЭД ьаЬьЦ┤эХШыКФ эФМыЮШъ╖╕
int rewardGiven[5] = {0}; // ъ░Б эАШьКдэК╕ьЭШ ы│┤ьГБ ьзАъ╕Й ьЧмы╢А ь╢ФьаБ ы░░ьЧ┤
int questAccepted[5] = {0};    // ъ░Б эАШьКдэК╕ьЭШ ьИШыЭ╜ ьЧмы╢А ь╢ФьаБ ы░░ьЧ┤
int questCompleted[5] = {0};   // ъ░Б эАШьКдэК╕ьЭШ ьЩДыгМ ьЧмы╢А ь╢ФьаБ ы░░ьЧ┤
int questKillCount[5] = {0};   // ъ░Б эАШьКдэК╕ьЭШ ыкмьКдэД░ ь▓Шь╣Ш ьИШ ь╣┤ьЪ┤эД░
int questItemCount[5] = {0};   // ъ░Б эАШьКдэК╕ьЭШ ьХДьЭ┤эЕЬ ьИШьзС ьИШ ь╣┤ьЪ┤эД░
int inventory[10] = {0};       // ьЭ╕ы▓дэЖаыжм ы░░ьЧ┤ (0ы▓И ьЭ╕ыН▒ьКдыКФ ьЧмьЭШьг╝ ьб░ъ░Б, 9ы▓И ьЭ╕ыН▒ьКдыКФ ьЩДьД▒ыРЬ ьЧмьЭШьг╝)
int hasKey = 0; // эЮИыУа ыз╡ ьЧ┤ьЗа ьЖМьЬа ьЧмы╢А эФМыЮШъ╖╕

// эФМыаИьЭ┤ьЦ┤ ьЭ┤ыкиьзА ьДдьаХ
int currentEmoji = 0;  // 0: ы▒А ЁЯРН, 1: ьЪй ЁЯРЙ
char* playerEmojis[] = {"ЁЯРН ", "ЁЯРЙ "}; // эФМыаИьЭ┤ьЦ┤ ьЭ┤ыкиьзА ы░░ьЧ┤

// ыкмьКдэД░ ьЭ┤ыкиьзА ьДдьаХ
const char* monsterEmojis[5] = {
    "ЁЯРМ",  // ыНШьаД 1: ыЛмэМ╜ьЭ┤ ьЭ┤ыкиьзА
    "ЁЯжО",  // ыНШьаД 2: ыПДызИы▒А ьЭ┤ыкиьзА
    "ЁЯХ╖я╕П ", // ыНШьаД 3: ыз╣ыПЕ ъ▒░ып╕ ьЭ┤ыкиьзА
    "ЁЯзЫ",  // ыНШьаД 4: ыУЬыЭ╝эБШыЭ╝ ьЭ┤ыкиьзА
    "ЁЯжЦ"    // ыНШьаД 5: эШ╝эЕМьЭ╝ ьЭ┤ыкиьзА (ы│┤ьКд)
};

// ыкмьКдэД░ ъ╡мьб░ь▓┤ ьаХьЭШ
typedef struct {
    int x, y; // ыкмьКдэД░ьЭШ эШДьЮм ьЬДь╣Ш
    int hp; // ыкмьКдэД░ьЭШ эШДьЮм ь▓┤ыае
    int alive; // ьГЭьб┤ ьЧмы╢А эФМыЮШъ╖╕ (1: ьВ┤ьХДьЮИьЭМ, 0: ьг╜ьЭМ)
    int move_counter; // ыкмьКдэД░ ьЭ┤ыПЩ ыФЬыаИьЭ┤ ь╣┤ьЪ┤эД░
    int shoot_counter; // ыкмьКдэД░ эГДэЩШ ы░ЬьВм ыФЬыаИьЭ┤ ь╣┤ьЪ┤эД░
    int type;  // ыкмьКдэД░ ьвЕыеШ (0 = ыЛмэМ╜ьЭ┤, 1 = ыПДызИы▒А ыУ▒)
    
} Monster;

Monster monsters[MAX_MONSTERS]; // ьЧмыЯм ыкмьКдэД░ые╝ ьаАьЮеэХа ы░░ьЧ┤
int monsterCount = 0; // эШДьЮм эЩЬьД▒эЩФыРЬ ыкмьКдэД░ ьИШ

// эММьЭ┤ьЦ┤ы│╝ ы░П ыкмьКдэД░ эГДэЩШ ъ╡мьб░ь▓┤ ьаХьЭШ
typedef struct {
    int x, y; // эММьЭ┤ьЦ┤ы│╝/эГДэЩШьЭШ эШДьЮм ьЬДь╣Ш
    int dx, dy; // ьЭ┤ыПЩ ы░йэЦе (x ы│АэЩФыЯЙ, y ы│АэЩФыЯЙ)
    int active; // эЩЬьД▒эЩФ ьЧмы╢А эФМыЮШъ╖╕ (true: эЩЬьД▒эЩФ, false: ы╣ДэЩЬьД▒эЩФ)
    int is_monster_bullet; // ыкмьКдэД░ эГДэЩШ ьЧмы╢А (1: ыкмьКдэД░ эГДэЩШ, 0: эФМыаИьЭ┤ьЦ┤ эММьЭ┤ьЦ┤ы│╝)
    int damage;  // эММьЭ┤ьЦ┤ы│╝/эГДэЩШьЭШ ыН░ып╕ьзА ъ░Т
    int move_counter; // эГДэЩШ ьЭ┤ыПЩ ыФЬыаИьЭ┤ ь╣┤ьЪ┤эД░
} Fireball;

Fireball fireballs[MAX_FIREBALLS]; // ьЧмыЯм эММьЭ┤ьЦ┤ы│╝/эГДэЩШьЭД ьаАьЮеэХа ы░░ьЧ┤

// эД░ып╕ыДР ьДдьаХ ы░▒ьЧЕьЪй ъ╡мьб░ь▓┤
struct termios orig_termios;

// ыкмьКдэД░ ьГЭьД▒ эХиьИШ
void spawnMonster(int x, int y, int type) {
    if (monsterCount < MAX_MONSTERS) { // ыкмьКдэД░ые╝ ьГЭьД▒эХа ъ│╡ъ░ДьЭ┤ ьЮИыКФьзА эЩХьЭ╕
        monsters[monsterCount].x = x; // ыкмьКдэД░ьЭШ ь┤Иъ╕░ X ьЬДь╣Ш ьДдьаХ
        monsters[monsterCount].y = y; // ыкмьКдэД░ьЭШ ь┤Иъ╕░ Y ьЬДь╣Ш ьДдьаХ
        monsters[monsterCount].alive = 1; // ыкмьКдэД░ые╝ ьВ┤ьХДьЮИыКФ ьГБэГЬыбЬ эСЬьЛЬ
        monsterOriginX[monsterCount] = monsters[monsterCount].x;    // ыжмьааьЭД ьЬДэХ┤ ьЫРыЮШ X ьЬДь╣Ш ьаАьЮе
        monsterOriginY[monsterCount] = monsters[monsterCount].y;    // ыжмьааьЭД ьЬДэХ┤ ьЫРыЮШ Y ьЬДь╣Ш ьаАьЮе
        monsters[monsterCount].move_counter = 0; // ьЭ┤ыПЩ ь╣┤ьЪ┤эД░ ь┤Иъ╕░эЩФ
        monsters[monsterCount].shoot_counter = 0; // ы░ЬьВм ь╣┤ьЪ┤эД░ ь┤Иъ╕░эЩФ
        monsters[monsterCount].type = type; // ыкмьКдэД░ эГАьЮЕ эХаыЛ╣
        // ыкмьКдэД░ HPые╝ эГАьЮЕьЧР ыФ░ыЭ╝ ьДдьаХ
        switch (type) {
            case 0: monsters[monsterCount].hp = 20; break;  // ыЛмэМ╜ьЭ┤ HP
            case 1: monsters[monsterCount].hp = 40; break;  // ыПДызИы▒А HP
            case 2: monsters[monsterCount].hp = 80; break;  // ыз╣ыПЕ ъ▒░ып╕ HP
            case 3: monsters[monsterCount].hp = 500; break;  // ыУЬыЭ╝эБШыЭ╝ (эЮИыУа) HP
            case 4: monsters[monsterCount].hp = 1000; break;  // эШ╝эЕМьЭ╝ (ы│┤ьКд) HP
            default: monsters[monsterCount].hp = 20; break; // ъ╕░ы│╕ HP
        }
        monsterCount++; // эЩЬьД▒эЩФыРЬ ыкмьКдэД░ ьИШ ьжЭъ░А
    }
}

// эММьЭ┤ьЦ┤ы│╝/эГДэЩШ ьГЭьД▒ эХиьИШ
void spawnFireball(int x, int y, int dx, int dy, int is_monster_bullet, int damage) {
    for (int i = 0; i < MAX_FIREBALLS; i++) { // эММьЭ┤ьЦ┤ы│╝ ы░░ьЧ┤ьЭД ьИЬэЪМ
        if (!fireballs[i].active) { // ы╣ДэЩЬьД▒эЩФыРЬ эММьЭ┤ьЦ┤ы│╝ ьКмыбпьЭД ь░╛ьЭМ
            fireballs[i].active = true; // эММьЭ┤ьЦ┤ы│╝ эЩЬьД▒эЩФ
            fireballs[i].x = x; // ь┤Иъ╕░ X ьЬДь╣Ш ьДдьаХ
            fireballs[i].y = y; // ь┤Иъ╕░ Y ьЬДь╣Ш ьДдьаХ
            fireballs[i].dx = dx; // X ы░йэЦе ьДдьаХ
            fireballs[i].dy = dy; // Y ы░йэЦе ьДдьаХ
            fireballs[i].is_monster_bullet = is_monster_bullet; // ыкмьКдэД░ эГДэЩШ ьЧмы╢А ьДдьаХ
            fireballs[i].damage = damage;  // ыН░ып╕ьзА ъ░Т ьДдьаХ
            break; // ьГЭьД▒ эЫД ыгиэФД ьвЕыгМ
        }
    }
}

// ыйФэЕМьШд ьКдэВм эХиьИШ (эФМыаИьЭ┤ьЦ┤ ьКдэВм)
void castMeteor() {
    if (strcmp(playerEmojis[currentEmoji], "ЁЯРЙ ") != 0) return;  // эФМыаИьЭ┤ьЦ┤ъ░А ьЪйьЭ╝ ыХМызМ ы░ЬыПЩ

    for (int i = 0; i < 10; i++) { // ь┤Э 10ы░ЬьЭШ ыйФэЕМьШд ыВЩэХШ
        int mx = rand() % COL; // ыз╡ ьЧ┤ ы▓ФьЬД ыВ┤ьЧРьДЬ ыЮЬыНд X ьЬДь╣Ш
        int my = 0; // ыз╡ ьГБыЛиьЧРьДЬ ьЛЬьЮС
        spawnFireball(mx, my, 0, 1, 0, 50); // ьХДыЮШыбЬ ьЭ┤ыПЩэХШыКФ эММьЭ┤ьЦ┤ы│╝ (ыйФэЕМьШд) ьГЭьД▒, 50 ыН░ып╕ьзА
    }
}

// ыУЬыЮШъ│д ы╕МыаИьКд ьКдэВм эХиьИШ (эФМыаИьЭ┤ьЦ┤ ьКдэВм)
void castDragonBreath(int px, int py, int last_dx, int last_dy, int is_monster_bullet) {
    // эФМыаИьЭ┤ьЦ┤ ьг╝ы│А 3x3 ьШБьЧньЭШ ьШдэФДьЕЛ (ызИьзАызЙ ьЭ┤ыПЩ ы░йэЦеьЭД ъ│аыад)
    int offsets[9][2] = {
        {-1, -1}, {0, -1}, {1, -1},
        {-1,  0}, {0,  0}, {1,  0},
        {-1,  1}, {0,  1}, {1,  1}
    };
    if (strcmp(playerEmojis[currentEmoji], "ЁЯРЙ ") != 0) return;  // эФМыаИьЭ┤ьЦ┤ъ░А ьЪйьЭ╝ ыХМызМ ы░ЬыПЩ

    for (int i = 0; i < 9; i++) {
        int fire_x = px + offsets[i][0] + last_dx; // эММьЭ┤ьЦ┤ы│╝ X ьЬДь╣Ш ъ│ДьВ░
        int fire_y = py + offsets[i][1] + last_dy; // эММьЭ┤ьЦ┤ы│╝ Y ьЬДь╣Ш ъ│ДьВ░
        spawnFireball(fire_x, fire_y, last_dx, last_dy, is_monster_bullet, 20); // эММьЭ┤ьЦ┤ы│╝ (ыУЬыЮШъ│д ы╕МыаИьКд) ьГЭьД▒, 20 ыН░ып╕ьзА
    }
}

// ыкмьКдэД░ ьЭ┤ыПЩ ы░П эГДэЩШ ы░ЬьВм эХиьИШ (ь╢Фъ░А)
void updateMonsters(int playerX, int playerY, char map[ROW][COL]) {
    for (int m = 0; m < monsterCount; m++) { // ыкиыУа ыкмьКдэД░ьЧР ыМАэХ┤ ы░Шы│╡
    if (!monsters[m].alive) { // ыкмьКдэД░ъ░А ьг╜ьЦ┤ьЮИыЛдый┤
        if (monsterRespawnTimer[m] > 0) { // ыжмьаа эГАьЭ┤ыи╕ъ░А ыВиьХДьЮИьЬ╝ый┤ ъ░РьЖМ
            monsterRespawnTimer[m]--;
        } else if (monsterRespawnTimer[m] == 0 && monsters[m].type <= 2) { // эГАьЭ┤ыи╕ъ░А 0ьЭ┤ъ│а ьЭ╝ы░Ш ыкмьКдэД░(эГАьЮЕ 0~2)ыЭ╝ый┤ ыжмьаа
            monsters[m].x = monsterOriginX[m]; // ьЫРыЮШ ьЬДь╣ШыбЬ ы│╡ъ╖А
            monsters[m].y = monsterOriginY[m];
            // ыкмьКдэД░ ыжмьаа эЫД ь▓┤ыае ьДдьаХ
            switch (monsters[m].type) {
                case 0: monsters[m].hp = 20; break;
                case 1: monsters[m].hp = 40; break;
                case 2: monsters[m].hp = 80; break;
                case 3: monsters[m].hp = 500; break; // ы│┤ьКд ыкмьКдэД░ыКФ ыжмьааэХШьзА ьХКыПДыбЭ ыРШьЦ┤ ьЮИьЬ╝ыВШ, эШ╣ьЛЬ ыкиые╝ ъ▓╜ьЪ░ые╝ ьЬДэХ┤ эПмэХи
                case 4: monsters[m].hp = 1000; break; // ы│┤ьКд ыкмьКдэД░ыКФ ыжмьааэХШьзА ьХКыПДыбЭ ыРШьЦ┤ ьЮИьЬ╝ыВШ, эШ╣ьЛЬ ыкиые╝ ъ▓╜ьЪ░ые╝ ьЬДэХ┤ эПмэХи
                default: monsters[m].hp = 20; break;
            }
            monsters[m].alive = 1; // ыкмьКдэД░ые╝ ыЛдьЛЬ ьВ┤ьХДьЮИыКФ ьГБэГЬыбЬ
            monsters[m].move_counter = 0; // ь╣┤ьЪ┤эД░ ь┤Иъ╕░эЩФ
            monsters[m].shoot_counter = 0; // ь╣┤ьЪ┤эД░ ь┤Иъ╕░эЩФ
        }
        continue; // ыЛдьЭМ ыкмьКдэД░ыбЬ ыДШьЦ┤ъ░Р
    }

        // ыкмьКдэД░ ьЭ┤ыПЩ ь▓Шыжм
        monsters[m].move_counter++;
        if (monsters[m].move_counter >= MONSTER_MOVE_DELAY) { // ьЭ┤ыПЩ ыФЬыаИьЭ┤ъ░А ь╢йьб▒ыРШый┤
            monsters[m].move_counter = 0; // ь╣┤ьЪ┤эД░ ь┤Иъ╕░эЩФ
            int dx = 0, dy = 0;
            // эФМыаИьЭ┤ьЦ┤ ы░йэЦеьЬ╝ыбЬ ьЭ┤ыПЩ ы░йэЦе ьДдьаХ
            if (monsters[m].x < playerX) dx = 1;
            else if (monsters[m].x > playerX) dx = -1;
            if (monsters[m].y < playerY) dy = 1;
            else if (monsters[m].y > playerY) dy = -1;

            int newX = monsters[m].x + dx; // ьГИыбЬьЪ┤ X ьЬДь╣Ш
            int newY = monsters[m].y + dy; // ьГИыбЬьЪ┤ Y ьЬДь╣Ш

            // ы▓╜, ьЮеьХаым╝, эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш, ыЛдые╕ ыкмьКдэД░ьЩА ь╢йыПМ ь▓┤эБм
            if (newX >= 0 && newX < COL && newY >= 0 && newY < ROW &&
                map[newY][newX] != '1' && map[newY][newX] != '2' && // ы▓╜('1')ьЭ┤ыВШ ьЮеьХаым╝('2')ьЭ┤ ьХДыЛМьзА эЩХьЭ╕
                !(newX == playerX && newY == playerY)) { // эФМыаИьЭ┤ьЦ┤ ьЬДь╣Шъ░А ьХДыЛМьзА эЩХьЭ╕
                int can_move = 1; // ьЭ┤ыПЩ ъ░АыКе ьЧмы╢А эФМыЮШъ╖╕
                for (int k = 0; k < monsterCount; k++) { // ыЛдые╕ ыкмьКдэД░ьЩА ь╢йыПМ ь▓┤эБм
                    if (k != m && monsters[k].alive && monsters[k].x == newX && monsters[k].y == newY) {
                        can_move = 0; // ьЭ┤ыПЩ ы╢Иъ░АыКе
                        break;
                    }
                }
                if (can_move) { // ьЭ┤ыПЩ ъ░АыКеэХШыЛдый┤
                    monsters[m].x = newX; // ыкмьКдэД░ ьЬДь╣Ш ьЧЕыН░ьЭ┤эК╕
                    monsters[m].y = newY;
                }
            }
        }

        // ыкмьКдэД░ эГДэЩШ ы░ЬьВм ь▓Шыжм
        monsters[m].shoot_counter++;
        if (monsters[m].shoot_counter >= MONSTER_SHOOT_DELAY) { // ы░ЬьВм ыФЬыаИьЭ┤ъ░А ь╢йьб▒ыРШый┤
            monsters[m].shoot_counter = 0; // ь╣┤ьЪ┤эД░ ь┤Иъ╕░эЩФ
            int dx = 0, dy = 0;
            // эФМыаИьЭ┤ьЦ┤ ы░йэЦеьЬ╝ыбЬ эГДэЩШ ы░ЬьВм ы░йэЦе ьДдьаХ
            if (monsters[m].x < playerX) dx = 1;
            else if (monsters[m].x > playerX) dx = -1;
            if (monsters[m].y < playerY) dy = 1;
            else if (monsters[m].y > playerY) dy = -1;
            if (dx != 0 || dy != 0) { // ы░йэЦеьЭ┤ ьЬаэЪиэХШый┤
                int sx = monsters[m].x + dx; // эГДэЩШ ьЛЬьЮС X ьЬДь╣Ш
                int sy = monsters[m].y + dy; // эГДэЩШ ьЛЬьЮС Y ьЬДь╣Ш
                if (sx >= 0 && sx < COL && sy >= 0 && sy < ROW) { // ьЬаэЪиэХЬ ыз╡ ы▓ФьЬД ыВ┤ыЭ╝ый┤
                    spawnFireball(sx, sy, dx, dy, 1, 10);  // ыкмьКдэД░ эГДэЩШ ьГЭьД▒, 10 ыН░ып╕ьзА
                }
            }
        }
    }
}

// эММьЭ┤ьЦ┤ы│╝ ьЧЕыН░ьЭ┤эК╕ эХиьИШ
void updateFireballs(char map[ROW][COL], int *playerHP, int *playerMaxHP, int playerX, int playerY) {
    
    for (int i = 0; i < MAX_FIREBALLS; i++) { // ыкиыУа эММьЭ┤ьЦ┤ы│╝ьЧР ыМАэХ┤ ы░Шы│╡
        if (fireballs[i].active) { // эЩЬьД▒эЩФыРЬ эММьЭ┤ьЦ┤ы│╝ьЭ┤ыЭ╝ый┤
            int newX = fireballs[i].x + fireballs[i].dx; // ьГИыбЬьЪ┤ X ьЬДь╣Ш
            int newY = fireballs[i].y + fireballs[i].dy; // ьГИыбЬьЪ┤ Y ьЬДь╣Ш

            // ыз╡ ъ▓╜ъ│Дые╝ ы▓ЧьЦ┤ыВШъ▒░ыВШ ы▓╜ьЧР ы╢АыФкэЮИый┤ эММьЭ┤ьЦ┤ы│╝ ы╣ДэЩЬьД▒эЩФ
            if (newX < 0 || newX >= COL || newY < 0 || newY >= ROW || map[newY][newX] == '1') {
                fireballs[i].active = 0;
            } else {
                // эФМыаИьЭ┤ьЦ┤ьЭШ эММьЭ┤ьЦ┤ы│╝ьЭ┤ ыкмьКдэД░ьЧР ызЮьХШыКФьзА эЩХьЭ╕
                if (!fireballs[i].is_monster_bullet) { // эФМыаИьЭ┤ьЦ┤ьЭШ эММьЭ┤ьЦ┤ы│╝ьЭ╕ ъ▓╜ьЪ░
                    for (int m = 0; m < monsterCount; m++) { // ыкиыУа ыкмьКдэД░ьЧР ыМАэХ┤ ы░Шы│╡
                        if (monsters[m].alive && monsters[m].x == newX && monsters[m].y == newY) { // ыкмьКдэД░ьЩА ь╢йыПМэЦИыЛдый┤
                            monsters[m].hp -= fireballs[i].damage;  // эММьЭ┤ьЦ┤ы│╝ьЭШ ыН░ып╕ьзАызМэБ╝ ыкмьКдэД░ ь▓┤ыае ъ░РьЖМ
                            if (monsters[m].hp <= 0) { // ыкмьКдэД░ ь▓┤ыаеьЭ┤ 0 ьЭ┤эХШый┤
                                monsters[m].alive = 0; // ыкмьКдэД░ ьг╜ьЭМ ь▓Шыжм
                                monsterRespawnTimer[m] = MONSTER_RESPAWN_DELAY; // ыжмьаа эГАьЭ┤ыи╕ ьДдьаХ
                                int type = monsters[m].type; // ьг╜ьЭА ыкмьКдэД░ьЭШ эГАьЮЕ ьаАьЮе

                                // эАШьКдэК╕ 1: ыЛмэМ╜ьЭ┤ (эГАьЮЕ 0)
                                if (type == 0 && questAccepted[0] && !questCompleted[0]) {
                                    if (questKillCount[0] < 10) questKillCount[0]++; // ь▓Шь╣Ш ьИШ ьжЭъ░А
                                    if (questItemCount[0] < 5 && rand() % 100 < 50) questItemCount[0]++; // 50% эЩХыеаыбЬ ьХДьЭ┤эЕЬ эЪНыУЭ
                                    if (questKillCount[0] >= 10 && questItemCount[0] >= 5) {
                                        if(queststop <= 0){ // ыйФьЛЬьзА ьдСы│╡ ь╢ЬыаеьЭД ызЙъ╕░ ьЬДэХЬ эФМыЮШъ╖╕
                                            printf("\nЁЯУЬ [эАШьКдэК╕ 1] ыкйэСЬ ыЛмьД▒! NPCьЧРъ▓М ыПМьХДъ░АьД╕ьЪФ.\n");
                                            usleep(1000000);
                                            queststop += 1;
                                        }
                                    }
                                }

                                // эАШьКдэК╕ 2: ыПДызИы▒А (эГАьЮЕ 1)
                                if (type == 1 && questAccepted[1] && !questCompleted[1]) {
                                    if (questKillCount[1] < 10) questKillCount[1]++;
                                    if (questItemCount[1] < 5 && rand() % 100 < 50) questItemCount[1]++;
                                    if (questKillCount[1] >= 10 && questItemCount[1] >= 5) {
                                        if(queststop <= 1){
                                            printf("\nЁЯУЬ [эАШьКдэК╕ 2] ыкйэСЬ ыЛмьД▒! NPCьЧРъ▓М ыПМьХДъ░АьД╕ьЪФ.\n");
                                            usleep(1000000);
                                            queststop += 1;
                                        }
                                    }
                                }

                                // эАШьКдэК╕ 3: ыз╣ыПЕ ъ▒░ып╕ (эГАьЮЕ 2)
                                if (type == 2 && questAccepted[2] && !questCompleted[2]) {
                                    if (questKillCount[2] < 10) questKillCount[2]++;
                                    if (questItemCount[2] < 5 && rand() % 100 < 50) questItemCount[2]++;
                                    if (questKillCount[2] >= 10 && questItemCount[2] >= 5) {
                                        if(queststop <= 2){
                                            printf("\nЁЯУЬ [эАШьКдэК╕ 3] ыкйэСЬ ыЛмьД▒! NPCьЧРъ▓М ыПМьХДъ░АьД╕ьЪФ.\n");
                                            usleep(1000000);
                                            queststop += 1;
                                        }
                                    }
                                }

                                // ыНШьаД 3 ыкмьКдэД░ (ыз╣ыПЕ ъ▒░ып╕) ь▓Шь╣Ш ьЛЬ, 19% эЩХыеаыбЬ ьЧ┤ьЗа ыУЬыЮН
                                if (type == 2 && rand() % 100 < 19 && !hasKey) {
                                    hasKey = 1; // ьЧ┤ьЗа эЪНыУЭ
                                    printf("\nЁЯЧЭя╕П ыз╣ыПЕ ъ▒░ып╕ъ░А эЮИыУа ыНШьаДьЭШ ьЧ┤ьЗаые╝ ыЦиьЦ┤ыЬиыа╕ьК╡ыЛИыЛд!\n");
                                    usleep(1500000);
                                }

                                // эАШьКдэК╕ 4: ыУЬыЭ╝эБШыЭ╝ (эГАьЮЕ 3)
                                if (type == 3 && questAccepted[3] && !questCompleted[3]) {
                                    questKillCount[3]++;
                                    questItemCount[3]++;
                                    if (questKillCount[3] >= 1 && questItemCount[3] >= 1) {
                                        printf("\nЁЯУЬ [эАШьКдэК╕ 4] ыкйэСЬ ыЛмьД▒! NPCьЧРъ▓М ыПМьХДъ░АьД╕ьЪФ.\n");
                                        usleep(1000000);
                                    }
                                }

                                // эАШьКдэК╕ 5: эШ╝эЕМьЭ╝ (эГАьЮЕ 4)
                                if (type == 4 && questAccepted[4] && !questCompleted[4]) {
                                    questKillCount[4]++;
                                    questItemCount[4]++;
                                    if (questKillCount[4] >= 1 && questItemCount[4] >= 1) {
                                        printf("\nЁЯУЬ [эАШьКдэК╕ 5] ыкйэСЬ ыЛмьД▒! NPCьЧРъ▓М ыПМьХДъ░АьД╕ьЪФ.\n");
                                        usleep(1500000);
                                    }
                                }

                                fireballs[i].active = 0; // эММьЭ┤ьЦ┤ы│╝ ы╣ДэЩЬьД▒эЩФ
                                goto skip_update; // эШДьЮм эММьЭ┤ьЦ┤ы│╝ ьЧЕыН░ьЭ┤эК╕ ъ▒┤ыДИыЫ░ъ│а ыЛдьЭМ эММьЭ┤ьЦ┤ы│╝ыбЬ
                            }
                        }
                    }
                }

                // ыкмьКдэД░ эГДэЩШьЭ┤ эФМыаИьЭ┤ьЦ┤ьЧР ызЮьХШыКФьзА эЩХьЭ╕
                if (fireballs[i].is_monster_bullet && newX == playerX && newY == playerY) {
                    
                //ыкмьКдэД░ъ░А эФМыаИьЭ┤ьЦ┤ьЧРъ▓М ьг╝ыКФ ыН░ып╕ьзА
                    if (monsters[i].type == 0) 
                        *playerHP -= 20;  
                    if (monsters[i].type == 1)
                        *playerHP -= 25;
                    if (monsters[i].type == 2)
                        *playerHP -= 30;
                    if (monsters[i].type == 3)
                        *playerHP -= 40;
                    if (monsters[i].type == 4)
                        *playerHP -= 50;
                    
                    if (*playerHP < 0) *playerHP = 0; // ь▓┤ыаеьЭ┤ 0 ып╕ызМьЬ╝ыбЬ ыВ┤ыадъ░АьзА ьХКъ▓М ы│┤ьаХ
                    fireballs[i].active = 0; // эГДэЩШ ы╣ДэЩЬьД▒эЩФ
                    goto skip_update; // эШДьЮм эГДэЩШ ьЧЕыН░ьЭ┤эК╕ ъ▒┤ыДИыЫ░ъ│а ыЛдьЭМ эГДэЩШьЬ╝ыбЬ
                }
                // ыкмьКдэД░ эГДэЩШьЭШ ьЭ┤ыПЩ ьЖНыПД ьаЬьЦ┤
                static int monsterBulletFrameCounter = 0; // ьаХьаБ ы│АьИШыбЬ эФДыаИьЮД ь╣┤ьЪ┤эД░
                monsterBulletFrameCounter++;
                if (fireballs[i].is_monster_bullet) {
                    fireballs[i].move_counter++;
                    if (fireballs[i].move_counter % MONSTER_BULLET_MOVE_DELAY != 0) { // ыФЬыаИьЭ┤ъ░А ь╢йьб▒ыРШьзА ьХКьЬ╝ый┤ ьЭ┤ыПЩ ъ▒┤ыДИыЫ░ъ╕░
                        continue;
                    }
                }

                // эММьЭ┤ьЦ┤ы│╝/эГДэЩШ ьЬДь╣Ш ъ░▒ьЛа
                fireballs[i].x = newX;
                fireballs[i].y = newY;
            }
        }
        skip_update:; // goto ым╕ьЭД ьЬДэХЬ ыаИьЭ┤ы╕Ф
    }
}

// эД░ып╕ыДР ьЫРьЛЬ ыкиыУЬ ы╣ДэЩЬьД▒эЩФ эХиьИШ (ьвЕыгМ ьЛЬ ьЫРыЮШыМАыбЬ ы│╡ъ╡м)
void disableRawMode() {
    tcsetattr(STDIN_FILENO, TCSAFLUSH, &orig_termios); // ьЫРыЮШ эД░ып╕ыДР ьДдьаХьЬ╝ыбЬ ы│╡ъ╡м
}

// эД░ып╕ыДР ьЫРьЛЬ ыкиыУЬ эЩЬьД▒эЩФ эХиьИШ (ьжЙьЛЬ эВд ьЮЕыае ь▓Шыжм ьЬДэХи)
void enableRawMode() {
    tcgetattr(STDIN_FILENO, &orig_termios); // эШДьЮм эД░ып╕ыДР ьДдьаХ ы░▒ьЧЕ
    atexit(disableRawMode); // эФДыбЬъ╖╕ыЮи ьвЕыгМ ьЛЬ disableRawMode эХиьИШ ьЮРыПЩ эШ╕ь╢Ь ыУ▒ыбЭ
    struct termios raw = orig_termios; // ы░▒ьЧЕыРЬ ьДдьаХьЭД ы│╡ьВм
    raw.c_lflag &= ~(ECHO | ICANON); // ECHO (ьЮЕыае ым╕ьЮР эЩФый┤ ь╢Ьыае) ы░П ICANON (ьаХъ╖Ь ыкиыУЬ, Enter эВд ьЮЕыаеъ╣МьзА ы▓ДэН╝ызБ) ы╣ДэЩЬьД▒эЩФ
    tcsetattr(STDIN_FILENO, TCSAFLUSH, &raw); // ьГИыбЬьЪ┤ ьДдьаХ ьаБьЪй (ы▓ДэН╝ эФМыЯмьЛЬ эЫД)
}

// ы╣Ды╕ФыбЬэВ╣ ы░йьЛЭьЬ╝ыбЬ ым╕ьЮР эХШыВШые╝ ьЭ╜ыКФ эХиьИШ
char getch_nonblock() {
    char c = 0;
    int flags = fcntl(STDIN_FILENO, F_GETFL, 0); // эШДьЮм эММьЭ╝ ыФФьКдэБмыж╜эД░ эФМыЮШъ╖╕ ъ░Аьа╕ьШдъ╕░
    fcntl(STDIN_FILENO, F_SETFL, flags | O_NONBLOCK); // O_NONBLOCK эФМыЮШъ╖╕ ь╢Фъ░А (ы╣Ды╕ФыбЬэВ╣ ыкиыУЬ)
    read(STDIN_FILENO, &c, 1); // ым╕ьЮР эХШыВШ ьЭ╜ъ╕░ (ьЮЕыаеьЭ┤ ьЧЖьЬ╝ый┤ ьжЙьЛЬ ы░ШэЩШ)
    fcntl(STDIN_FILENO, F_SETFL, flags); // ьЫРыЮШ эФМыЮШъ╖╕ыбЬ ы│╡ъ╡м (ы╕ФыбЬэВ╣ ыкиыУЬ)
    return c; // ьЭ╜ьЭА ым╕ьЮР ы░ШэЩШ
}

// ы╕ФыбЬэВ╣ ы░йьЛЭьЬ╝ыбЬ ым╕ьЮР эХШыВШые╝ ьЭ╜ыКФ эХиьИШ (Enterые╝ ъ╕░ыЛдыжмьзА ьХКьЭМ)
char getch() {
    char c;
    if (read(STDIN_FILENO, &c, 1) == 1) // ым╕ьЮР эХШыВШые╝ ьЭ╜ъ│а ьД▒ъ│╡эХШый┤
        return c; // ьЭ╜ьЭА ым╕ьЮР ы░ШэЩШ
    else
        return 0; // ьЛдэМи ьЛЬ 0 ы░ШэЩШ
}

// ым╝ьХ╜ ьГБьаР ьЧ┤ъ╕░ эХиьИШ
void openPotionShop(int* gold, int* potion1_hp, int* potion2_hp, int* potion3_hp) {
    char choice;
    while (1) {
        printf("\033[H\033[J"); // эЩФый┤ ьзАьЪ░ъ╕░ ы░П ь╗дьДЬ эЩИьЬ╝ыбЬ ьЭ┤ыПЩ
        printf("\n---------- ЁЯПе ым╝ьХ╜ ьГБьаРьЧР ьШдьЛа ъ▓ГьЭД эЩШьШБэХйыЛИыЛд! ----------\n");
        printf("\n");
        printf("            ы│┤ьЬа ъ│иыУЬ: ЁЯТ░ %dG\n", *gold);
        printf("\n");
        printf("            1. эХШъ╕Й ь▓┤ыае ым╝ьХ╜ (ЁЯТЪ ) - 10G\n");
        printf("              - ь▓┤ыае эЪМы│╡ыЯЙ + 10            \n\n");
        printf("            2. ьдСъ╕Й ь▓┤ыае ым╝ьХ╜ (ЁЯТЩ ) - 30g\n");
        printf("              - ь▓┤ыае эЪМы│╡ыЯЙ + 30            \n\n");
        printf("            3. ьГБъ╕Й ь▓┤ыае ым╝ьХ╜ (ЁЯТЦ ) - 100g\n");
        printf("              - ь▓┤ыае эЪМы│╡ыЯЙ + 70            \n\n");
        printf("            4. ыВШъ░Аъ╕░\n");
        printf("\n");
        printf("----------------------------------------------------------\n");
        
        choice = getch(); // ьВмьЪйьЮР ьЮЕыае ыМАъ╕░
        if (choice == 0x1b) { // ESC эВд ьЮЕыае ь▓Шыжм (ы░йэЦеэВд ыУ▒ьЭШ ы│╡эХй ьЮЕыае ы░йьзА)
            getch(); getch();
            continue;
        }

        if (choice == '1') { // эХШъ╕Й ым╝ьХ╜ ъ╡мызд
            if (*gold >= 10) {
                *gold -= 10;
                (*potion1_hp)++;
                printf("ЁЯТЪ эХШъ╕Й ь▓┤ыае ым╝ьХ╜ьЭД ъ╡мыздэЦИьК╡ыЛИыЛд! (ыВиьЭА ъ│иыУЬ: %dG)\n", *gold);
            } else {
                printf("тЭЧ ъ│иыУЬъ░А ы╢Аьб▒эХйыЛИыЛд!\n");
            }
        } else if (choice == '2') { // ьдСъ╕Й ым╝ьХ╜ ъ╡мызд
            if (*gold >= 30) {
                *gold -= 30;
                (*potion2_hp)++;
                printf("ЁЯТЩ ьдСъ╕Й ь▓┤ыае ым╝ьХ╜ьЭД ъ╡мыздэЦИьК╡ыЛИыЛд! (ыВиьЭА ъ│иыУЬ: %dG)\n", *gold);
            } else {
                printf("тЭЧ ъ│иыУЬъ░А ы╢Аьб▒эХйыЛИыЛд!\n");
            }
        } else if (choice == '3') { // ьГБъ╕Й ым╝ьХ╜ ъ╡мызд
            if (*gold >= 100) {
                *gold -= 100;
                (*potion3_hp)++;
                printf("ЁЯТЦ ьГБъ╕Й ь▓┤ыае ым╝ьХ╜ьЭД ъ╡мыздэЦИьК╡ыЛИыЛд! (ыВиьЭА ъ│иыУЬ: %dG)\n", *gold);
            } else {
                printf("тЭЧ ъ│иыУЬъ░А ы╢Аьб▒эХйыЛИыЛд!\n");
            }
        } else if (choice == '4') { // ьГБьаР ыВШъ░Аъ╕░
            printf("ьГБьаРьЭД ыВШъ░СыЛИыЛд...\n");
            usleep(1000000); // 1ь┤И ыМАъ╕░
            break; // ыгиэФД ьвЕыгМ
        } else {
            printf("тЭЧ ьЮШык╗ыРЬ ьЮЕыаеьЮЕыЛИыЛд. ыЛдьЛЬ ьДаэГЭэХ┤ьг╝ьД╕ьЪФ.\n");
        }
        usleep(1000000); // 1ь┤И ыМАъ╕░
    }
}

// ь╣┤ьзАыЕ╕ ъ▓МьЮД эХиьИШ (ьКмыбп ыи╕ьЛа)
void playCasino(int* gold) {
    int bet = 0; // ы▓аэМЕ ъ╕ИьХб
    int num[3]; // ьКмыбп ыи╕ьЛа ьИльЮР 3ъ░Ь
    int reward = 0; // ыИДьаБ ыЛ╣ь▓иъ╕И
    char ch; // ьЮЕыае ым╕ьЮР

    if (*gold < 10) { // ь╡ЬьЖМ ы▓аэМЕ ъ╕ИьХб ып╕ыЛм ьЛЬ
        printf("\nЁЯТ╕ ь╡ЬьЖМ 10G ьЭ┤ьГБ ьЮИьЦ┤ьХ╝ ьКмыбпыи╕ьЛаьЭД ыПМыж┤ ьИШ ьЮИьК╡ыЛИыЛд!\n");
        printf("ъ▓МьЮДьЬ╝ыбЬ ыПМьХДъ░СыЛИыЛд...\n");
        usleep(1000000);
        return; // эХиьИШ ьвЕыгМ
    }

    while (1) {
        if (*gold <= 0) { // ъ│иыУЬъ░А ыкиыСР ьЖМьзДыРШый┤
            printf("\nЁЯТ╕ ъ│иыУЬъ░А ыкиыСР ьЖМьзДыРШьЦ┤ ь╣┤ьзАыЕ╕ьЧРьДЬ эЗ┤ьЮеэХйыЛИыЛд...\n");
            usleep(1000000);
            break; // ыгиэФД ьвЕыгМ
        }

        printf("\033[H\033[J"); // эЩФый┤ ьзАьЪ░ъ╕░
        printf("\n------------ ЁЯО░ ьКмыбпыи╕ьЛа ъ▓МьЮДьЧР ьШдьЛа ъ▓ГьЭД эЩШьШБэХйыЛИыЛд! --------------\n");
        printf("\n");
        printf("эШДьЮм ъ│иыУЬ: %dG\n", *gold);
        printf("ыИДьаБ ыЛ╣ь▓иъ╕И : %dG\n", reward);
        printf("\n------------------------------------------------------------------\n");
        printf("ы░░эМЕ ъ╕ИьХбьЭД ьЮЕыаеэХШьД╕ьЪФ (ьИльЮР ьЮЕыае эЫД Enter): ");
        fflush(stdout); // ь╢Ьыае ы▓ДэН╝ ы╣ДьЪ░ъ╕░

        char buffer[10] = {0}; // ьЮЕыае ы▓ДэН╝
        int index = 0; // ы▓ДэН╝ ьЭ╕ыН▒ьКд

        while (1) { // ы▓аэМЕ ъ╕ИьХб ьЮЕыае ыгиэФД
            ch = getch(); // ым╕ьЮР эХШыВШ ьЭ╜ъ╕░
            if (ch == '\n' || ch == '\r' || ch == 13) break; // Enter эВд ьЮЕыае ьЛЬ ьвЕыгМ
            if (ch >= '0' && ch <= '9' && index < 9) { // ьИльЮРьЭ┤ъ│а ы▓ДэН╝ ъ│╡ъ░ДьЭ┤ ьЮИыЛдый┤
                buffer[index++] = ch; // ы▓ДэН╝ьЧР ь╢Фъ░А
                putchar(ch); // эЩФый┤ьЧР ьЧРь╜Ф (ьЮЕыае ым╕ьЮР эСЬьЛЬ)
                fflush(stdout);
            } else if ((ch == 127 || ch == 8) && index > 0) { // Backspace эВд ьЮЕыае ьЛЬ
                index--; // ьЭ╕ыН▒ьКд ъ░РьЖМ
                buffer[index] = '\0'; // ы▓ДэН╝ьЧРьДЬ ым╕ьЮР ьаЬъ▒░
                printf("\b \b"); // эЩФый┤ьЧРьДЬ ым╕ьЮР ьзАьЪ░ъ╕░
                fflush(stdout);
            }
        }
        buffer[index] = '\0'; // ым╕ьЮРьЧ┤ ьвЕыгМ ыДР ым╕ьЮР ь╢Фъ░А
        printf("\n");

        bet = atoi(buffer); // ьЮЕыаеыРЬ ым╕ьЮРьЧ┤ьЭД ьаХьИШыбЬ ы│АэЩШ
        if (bet <= 0) { // 0 ьЭ┤эХШ ъ╕ИьХб ы▓аэМЕ ьЛЬ
            printf("тЭЧ 0 ьЭ┤эХШьЭШ ъ╕ИьХбьЭА ы░░эМЕэХа ьИШ ьЧЖьК╡ыЛИыЛд!\n");
            printf("тЭЧ ъ│╝ыПДэХЬ ыПДы░ХьЭА ык╕ьЧР эХ┤ыбньК╡ыЛИыЛд.\n");
            usleep(1000000);
            continue; // ыЛдьЛЬ ы▓аэМЕ ъ╕ИьХб ьЮЕыае
        }
        if (bet > *gold) { // ы│┤ьЬа ъ│иыУЬ ь┤Иъ│╝ ы▓аэМЕ ьЛЬ
            printf("\nтЭЧ ы│┤ьЬа ъ│иыУЬые╝ ь┤Иъ│╝эХЬ ъ╕ИьХбьЮЕыЛИыЛд!\n");
            usleep(1000000);
            continue; // ыЛдьЛЬ ы▓аэМЕ ъ╕ИьХб ьЮЕыае
        }

        *gold -= bet; // ы▓аэМЕ ъ╕ИьХбызМэБ╝ ъ│иыУЬ ъ░РьЖМ
        srand(time(NULL)); // ыВЬьИШ ьЛЬыУЬ ьДдьаХ (эШДьЮм ьЛЬъ░Д ъ╕░ьдА)
        num[0] = rand() % 9 + 1; // 1ы╢АэД░ 9ъ╣МьзА ыЮЬыНд ьИльЮР ьГЭьД▒
        num[1] = rand() % 9 + 1;
        num[2] = rand() % 9 + 1;

        printf("\nЁЯО░ ъ▓░ъ│╝: [ %d ] [ %d ] [ %d ]\n", num[0], num[1], num[2]); // ъ▓░ъ│╝ ь╢Ьыае

        if (num[0] == 7 && num[1] == 7 && num[2] == 7) { // ьЮнэМЯ (777)
            int prize = bet * 777; // 777ы░░ ы│┤ьГБ
            reward += prize; // ыИДьаБ ыЛ╣ь▓иъ╕И ьжЭъ░А
            *gold += bet; // ы▓аэМЕ ъ╕ИьХбьЭА ыПМыады░ЫьЭМ (ьИЬьИШ ьЭ┤ыУЭьЭА prize - bet)
            printf("ЁЯОЙ JACKPOT! 1ыУ▒ ыЛ╣ь▓и! 777ы░░ ыИДьаБ! (ьЭ┤ы▓И ыЛ╣ь▓иъ╕И: %dG)\n", prize);
        } else if (num[0] == num[1] && num[1] == num[2]) { // ьД╕ ьЮРыжм ыкиыСР ъ░ЩьЭМ
            int prize = bet * 5; // 5ы░░ ы│┤ьГБ
            reward += prize;
            *gold += bet;
            printf("тЬи 2ыУ▒! 5ы░░ ыИДьаБ! (ьЭ┤ы▓И ыЛ╣ь▓иъ╕И: %dG)\n", prize);
        } else if (num[0] == num[1] || num[0] == num[2] || num[1] == num[2]) { // ыСР ьЮРыжм ъ░ЩьЭМ
            int prize = bet * 2; // 2ы░░ ы│┤ьГБ
            reward += prize;
            *gold += bet;
            printf("ЁЯСН 3ыУ▒! 2ы░░ ыИДьаБ! (ьЭ┤ы▓И ыЛ╣ь▓иъ╕И: %dG)\n", prize);
        } else { // ъ╜Э
            int loss = (*gold > 10) ? (*gold / 10) : 1; // эШДьЮм ъ│иыУЬьЭШ 10% ыШРыКФ ь╡ЬьЖМ 1ъ│иыУЬ ь╢Фъ░А ь░иъ░Р
            *gold -= loss;
            printf("ЁЯТФ ъ╜ЭьЮЕыЛИыЛд. ъ│иыУЬьЭШ 10%%(%dG) ь╢Фъ░А ь░иъ░РыРйыЛИыЛд.\n", loss);
        }

        printf("эШДьЮм ъ│иыУЬ: %dG | ыИДьаБ ыЛ╣ь▓иъ╕И: %dG\n", *gold, reward); // эШДьЮм ъ│иыУЬ ы░П ыИДьаБ ыЛ╣ь▓иъ╕И ь╢Ьыае
        printf("-----------------------------------------------------\n\n");
        printf("ЁЯО░ ьЮмьЛЬьЮС : 1 / ьвЕыгМ : 0 \n");
        printf(">> ");
        fflush(stdout);

        char again_ch;
        while (1) { // ьЮмьЛЬьЮС/ьвЕыгМ ьДаэГЭ ыгиэФД
            again_ch = getch();
            if (again_ch == '0') { // 0 ьЮЕыае ьЛЬ ьвЕыгМ
                printf("\nь╣┤ьзАыЕ╕ые╝ ьвЕыгМэХйыЛИыЛд...\n");
                if (reward > 0) { // ыИДьаБ ыЛ╣ь▓иъ╕ИьЭ┤ ьЮИыЛдый┤ ьзАъ╕Й
                    printf("ЁЯОБ ыИДьаБ ыЛ╣ь▓иъ╕И %dGые╝ ьзАъ╕ЙэХйыЛИыЛд!\n", reward);
                    *gold += reward;
                    reward = 0; // ыИДьаБ ыЛ╣ь▓иъ╕И ь┤Иъ╕░эЩФ
                }
                usleep(1000000);
                return; // эХиьИШ ьвЕыгМ
            } else if (again_ch == '1') { // 1 ьЮЕыае ьЛЬ ьЮмьЛЬьЮС
                break; // ьЮмьЛЬьЮС ыгиэФДыбЬ ьЭ┤ыПЩ
            } else {
                printf("\nтЭЧ ьЮШык╗ыРЬ ьЮЕыаеьЮЕыЛИыЛд. 0 ыШРыКФ 1 ызМ ьЮЕыае ъ░АыКеэХйыЛИыЛд.\n");
                printf(">> ");
                fflush(stdout);
            }
        }
    }

    if (reward > 0) { // ъ▓МьЮД ьвЕыгМ эЫД ыВиьЭА ыИДьаБ ыЛ╣ь▓иъ╕ИьЭ┤ ьЮИыЛдый┤ ьзАъ╕Й
        printf("\nЁЯОБ ыИДьаБ ыЛ╣ь▓иъ╕И %dGые╝ ьзАъ╕ЙэХйыЛИыЛд!\n", reward);
        *gold += reward;
    }
    printf("ъ▓МьЮД ьвЕыгМ эЫД ь┤Э ъ│иыУЬ: %dG\n", *gold);
    usleep(1000000);
}

// ъ▓МьЮД ьГБэГЬ ь┤Иъ╕░эЩФ эХиьИШ (ьЮмьЛЬьЮСьЪй)
void resetGame(int *playerX, int *playerY, int *playerHP, int *playerMaxHP, char **currentMapName, char map[ROW][COL], char map_backup[ROW][COL]) {
    *playerX = 1; // эФМыаИьЭ┤ьЦ┤ X ьЬДь╣Ш ь┤Иъ╕░эЩФ
    *playerY = 18; // эФМыаИьЭ┤ьЦ┤ Y ьЬДь╣Ш ь┤Иъ╕░эЩФ
    *playerHP = 100; // эФМыаИьЭ┤ьЦ┤ HP ь┤Иъ╕░эЩФ
    *currentMapName = "ызИьЭД"; // эШДьЮм ыз╡ ьЭ┤ыжДьЭД "ызИьЭД"ыбЬ ьДдьаХ
    memcpy(map, map_backup, sizeof(char) * ROW * COL); // ыз╡ьЭД ы░▒ьЧЕ ыз╡ьЬ╝ыбЬ ы│╡ъ╡м
    monsterCount = 0; // ыкмьКдэД░ ьИШ ь┤Иъ╕░эЩФ
    for (int i = 0; i < MAX_FIREBALLS; i++) { // ыкиыУа эММьЭ┤ьЦ┤ы│╝ ы╣ДэЩЬьД▒эЩФ
        fireballs[i].active = 0;
    }
}

// ь╢Ьыае ьВмьЭ┤ьЭШ ыМАъ╕░ ьЛЬъ░Д (ь┤И)
#define STORY_DELAY 2

// =================================================================
// ==================== ASCII Art ьВ╜эЩФ ыН░ьЭ┤эД░ =======================
// =================================================================
// ьЪй ы│┤ьКд (Horntail) ASCII ьХДэК╕ ы░░ьЧ┤
const char* dragonBoss[] = {
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбЕтаАтаАтаАтвАтбЗтаАтаАтвАтаДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтватаГтвАтаДтвАтг╝таГтб░твАтбЮтбатаБтаАтбатаДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаДтаАтаВтаРтватвЮтбдтбЪтг░тг┐твПтг╝тб╖тг┐твЛтгатаЦтвЙтаАтбАтаДтаВтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбАтвИтаАтаВтвДтвБтб╕тватб┐тготвотг╛тг┐тв┐тгЯтг╜тгЯтг╖тгЯтгбтг╢тб╡твКтгБтадтаФтаВтаЙтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаДтаатвАтаМтавтавтг░твптгЯтгЧтгптб┐тблтб╗твотбптг╛тг╜тгптв┐тб┐тгптг╛тгПтгБтвДтаАтбАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбАтвитг╛тг╗та╢тгжтв╡тгЯтв│твптб╗тбнтг╗тгЮтгптв╛тгЯтг┐тг╗тг│тг╜тгЮтв┐тг╜тгЯтг┐тготаЦтажтавтадтбатбАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтбАтгАтаатаАтаДта╕талтб╣тблтвЮтв┐твЮтг╖тг╡тгЯтвотаЮтботвотб╗тгЭтгзтг┐тг╡тг╖тгЭтб┐тготвптб╖тг┐тв┐тг╖тгжтгДтбВтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтв░таЙтаАтбЙтаЙтаЪтавтажтгДта╣тгМтг│тг▒тг╝твЮтгЮтг║тбптб╗тв╡тб┐тг╜твнтбЮтб╢твзтгЭтгЭтбЮтг┐тг╜тг╗тгЯтг┐тг╗тбЯтв┐тбУтавтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАта│твДтвАтаИтаатаБтввтб┤тг╛тв╛та╜тбнтаЫтв╗тг┐тг│твптгЭтгЧтг┐тг╗твотгПтгЭтб│тгЭтвотб┐тгЮтг╖тв┐тг╜тб┐тг┐тг┐тбжтгНтавтбДтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбАтаБтаатаБтаАта╗тбПтаБтаАтаАтаАтаАтагтв╗тбЩтвптгптбКта╗тгжтб╣тбЪтвмтаСтаптгЪтвЯтг┐тг╗тгЯтг┐тг┐тгптг┐тбвтбСтаИтаБтаАтаИ",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаВтаАтаБтаАтаАтаАтаАтаВтаатвАтаАтбАтаСтаДтвАтаЩтагтаДтбЩтвЖтаАтаатаАтаатбИтг╖тв┐тб┐тгптг┐тгЯтг┐тг╖тбМтаАтаАтаВтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбРтгатгвтг╛тг┤тг╖тготгЦтгВтгатгДтбатаАтаДтвАтаАтбБтвАтаАтв▓тготг┐тв╜тг┐тг┐тб┐тг┐тгЫтвпта╗тгЖтаМтаВтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаИтаАтаАтаИтг┤тв┐тб┐тг┐тг┐тв┐тг┐тг╗тб┐тг┐тг┐тг╖тг╢тг╡тбдтаФтгатг┤тг┤тгЯтг┐тг│тг┐тв╜тг┐тг╛таЯтгптвгтаИтвзтаЩтвДтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтг╝тг┐тг╗тв┐тапта╗таЫтаЧта┐та╜тг╖тг│тгптг╛тгЮтб┐тг┐твЯтб╖тг╗твотг╖тг┐твптг┐тв┐тбЯтаАтб╖тб┤таГтаАтаБтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтг╕тг┐тг┐тг╗тб╖тгДтб░тгатгйтб╡тг│тв╜тб│тг╖тглтгЮтв╜тбЮтгптг╗тб╜тг╗тг╖тг┐тб│тб┐тбСтаАтаБтаЗтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтв╕тг┐тг┐тб╜тгптгптглтв╖тв╡тб╜тг╛тблтб╗тг╡тг╖тг╗тг╜тг┐тг┐тгктг┐тг╗тв╖твЭтг┐тг╖тг╖тгДтаАтаАтаРтаБтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаЩтв┐тг╜тб╖тг╖тг╗тгЧтг┐тг║тг╖тгЫтг┐тг╗тгЮтгптб╖тгптб┐тг║тбзтглтгЧтг┐тв┐тг╛тг╗тгПтг┤тгДтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаЙтбЩтаЯтв┐тб┐тг╜тг┐тг║тв╖тбптг┐тб╜таЙтаЫтб╜та╕тгптг┐тб╜тг╛тбПтв╗тг╜тв╖тг╜тгЯтг┐тг┐тбАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтвАтаАтаИтаатаЪтгбтб┐тг╜тб┐тгптв┐тг╜таЫтаЪтгАтватгАтгмтг┐тгЮтг┐тг╜тбзтаАтв╗тг╖тб┐тв╜тбЛтв╗тгзтаАтаАтаАтаАтаА",
"таАтвАтаАтаАтаАтаАтаАтгАтгАтг▒тгвтг┐тг┐тг╢тг╛тг╡тг┐тг┐тг╗тб┐тг┐тгнтгЯтг╖тгптг┐тг╗тб╛тг╖тв┐тгЯтг┐таЗтаАтг╜тгЗтг┤таВтаЛтб╕таГтаАтаАтаАтаАтаА",
"таАтаАтавтаатгДтаАтаЙтвжтбАтв╕тг║тг╢тг┐тг┐тгЯтг┐тг╜твптб┐тг┐тг╜тгЯтг┐тг╗тб┐тг╛тб╜тгЧтб┐тг╛тг╜тг╗таПтаАтаатаИтаЙтаАтаАтаатаАтаАтвАтаАтаАтаАтаА",
"тгИтаБтаУта╢тгдтгЩтг│тгжтг┐тб┐тгЯтг┐тб║тг╛тгЭтг┐тв╛тгЯтг┐тг│тг┐тг╜тв╖тгЯтг┐тгЮтг┐тб╜тг┐тв╛тгптб┐та╜таПтаБтаАтаАтаАтаАтаВтаАтаАтаАтаАтаАтаВтаАтаАтаАтаА",
"таЙтаЩта│та╢тг╢тг╜тг┐тв╛тг╖твптб┐тгЮтг┐тг╗тг╛тб╜тгптаЛтвБтгЙтгитгНтгптб╗тг╛тг╜тбПтаЙтаЙтаЙтаБтаБтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаатбатвмтв┐тг┐тг┐тг╗тгЯтг╜тб┐тгптг┐тг┐тг┐тг┐тгЯтб┐тг╗тгптб┐тг║тв╛тгЧтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтг░тг┐тгптг┐тг╗тб┐таЭтаЫтаЭтаБтаЩтаЪтаЫтб╛тг╖тб╕тг┐тбЮтвЭтг┐тв┐тгДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаБтвНтг╖тв┐тготв┐тгзтаАтаАтаАтаАтаАтаАтаИтаАтаЩтаАтаГтаАтаАтаИта╗тв┐тг╖тгдтгАтбАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтбРтв╣тгЯтг╛твптг┐тгДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтватб┐таЫтг┐тг┐тгзтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАта╗тгЯтгптг┐тг╗тг╖тгжтгдтг╢тгЯтг╢тг╖тг╡тг╢тб╖тг╢тгетгдтгАтгЫта╛тг┐тб╛тг┐таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаИта╣тбПта┐тг╜тв┐тг┐тг╗тг┐тг╜тг╖тг┐тг╜тг┐тг╗тгЯтг┐тг┐тг┐тг┐тгптб╜таГтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаЙтавтгДтбИтаАтаИтаСтаМтаЩтаТтадтаАтаАтаАтаАтаАтаАтаАтаАтаЙтаЪтв┐тг┐тг╖тбАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаЩта┐тг╢тгдтгДтгИтгТтгдтбИтввтбДтаАтвДтаАтаАтаАтаАтаАтаИтг┐тг┐тбПтвДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаИтаЩта╗тгптб┐тг╜тг╗тв╖тв┐тг╖тгдтг│тгФтгдтгвтгДтг╢тг┐тг┐таГтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаатгАтгДтг┐тг┐тв╖тгЯтб┐тг╛тг╜тглтгптв┐тг╜тгЯтг┐тг╜таЗтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтвАтвАтгДтгитг╖тг┐тг╗тгЯтг╖тв┐тгЮтг╖тг┐тг│тгЯтг┐таОтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтадтаТтвЛтбнтаЭтг╗тбпта╖твЫтаЭтб╝таСтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаИтаБтаАтаШтаИтаАтаАтаБтаАтаБтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА ",

};

// ыУЬыЮШъ│д ьаДэИм ьЮеый┤ ASCII ьХДэК╕ ы░░ьЧ┤
const char* dragonFight[] = {
"таАтаАтаИтаДтбБтаВтаАтаИтаДтабтвИтаАтаАтабтвИтаРтаАтаАтаИтаДтбБтаВтаАтаАтабтвИтаРтаАтаАтабтвИтаРтаАтаАтаИтаДтбБтаВтаАтаАтаб",
"тбРтаатвИтаРтаАтбБтаВтаМтбАтаБтвВтаРтаатаБтаВтаИтбРтаатвИтаРтаАтбБтаВтаДтбБтаВтвИтаРтаатаБтаВтаИтбРтаатвИтаРтаАтвБтаВтаДтбБтаВтвИтаРтаатаБтаВтаИтбРтаатвИтаРтаАтвБтаВтаДтбБ",
"таДтаБтвВтаАтбАтаДтаБтаВтаДтбАтаатаИтаДтбБтвАтаАтаДтаБтвВтаАтбАтаДтаБтаВтаДтгАтаВтаМтаатвБтаАтбАтаДтаБтвВтаАтбАтаатаИтаРтбАтвАтаатаИтаДтбБтвАтаАтаДтаБтвВтаАтбАтаатаИтаФтбА",
"таАтаАтвАтаВтбРтаАтаАтвИтаРтаатвБтаАтаАтбРтаатвИтаАтаАтвАтаВтбРтаАтаАтаатаИтаДтбИтаАтаАтвВтаРтаатаАтаАтвАтаВтаДтбБтаАтаАтбРтвАтаВтаАтаАтбРтаатвИтаАтаАтвАтаВтадтвБтаВтаАтбР",
"таМтбРтаатаАтаАтабтаИтаДтбИтватадтгМтгРтгАтаБтаАтаМтбРтаатаАтаАтабтаИтаДтбБтаАтаатаБтаМтбАтаИтаАтабтвИтгДтгИтгдтг┤тгзтг╢тг╢тг╢тг╝тгдтгетгдтгетгдтгмтг┤тгатгИтгДтаатвИтаРтбА",
"таВтаАтвБтаВтаДтбБтаИтаРтгАтгВтгФтгатг┤тг╝тг┐тг┐тг╢тгжтгетгВтбДтаБтаИтаРтбАтаВтаДтаБтаВтгРтгдтг╢тг┐тгЯтг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐таЯтаЛтаНтбЙтаАтаВтаДтаД",
"твАтаАтаатгМтг╢тг╢тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐та┐та┐та╖та╢тгдтгбтбИтвАтаШтбЙтаДтаатвБтаЙтбЩта╗тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╖тгптг┐тгжтгБтаВтаДтбАтаАтаМ",
"таВтаМтбРтвйтг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐та┐таЫтаЯтазтгДтаВтаДтабтаАтаАтаЩтбЖтаРтбАтаАтгДтвЖтб░тгАта░тбЙтаМта╣тг┐тг┐тг┐тг┐тг┐тг┐тг┐тб╜твптбЯтг┐тг┐тг┐тг╢тгдтвАтаБтаВ",
"таБтаАтаРтг┤тг╛тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тб┐таЛтаДтаИтаАтвИтаРтбАтгПтаИтбДтабтвИтаРтаАтаБтаДтбБтаЪтазтг│тветбУтвдтаИтаАтбИта╗тг┐тг┐тг┐тг┐тг┐тг┐тг╖тб╣твзтг┐таБтаВтаМтаАтаИтбР",
"твВтаРтбИтгЙтг╣тг┐тг┐тг┐тг┐тг┐тг┐тг┐тв┐тбБтаМтаРтбАтвЖтг┤тготг┤тг┐тг▓тбДтгГтаДтвИтаРтбАтаВтаДтаБтвВтв╕твгтг╗твЖтб╣таДтаДтабтаЩтг┐тг┐тг┐тб╖тгПта┐тг┐тгЯтг╛тбДтаБтввтаРтаатаА",
"таДтвВтаРтг╗твЫтбЩтв╗тб╜тгОта╖тг┐тг┐тг┐тбАтвАтавтг╜тг┐тг┐тг┐тг┐тг┐тг┐тб╜тгЖтбЖтвАтаВтаДтбБтвАтв░тв╕тгбтг╛тг╖тг╛тг┐тг╗тгмтаРтбАтг┐тг┐тг┐тб┐тгнта│тгНтв┐тг┐тг┐тгОтвзтаИтаДтбБ",
"таАтаАтаАтбЯтб╝тв░таЬтв│тгОтв│тб╣тг┐тг┐тг╖тгДтвЪтг┐тг┐тг┐тбЯтбЙта╗тг┐тг┐тг┐тгзтаАтаАтаАтбРтвАтг╛тг╗тг╝тг┐тг┐тв┐тг┐тг┐тг┐тгзтг╝тг┐тг┐тг┐твЯтб▓тб╣тгМтв┐тб╜тбРтвптв│таАтаАтбР",
"таМтаатаБтг┐тгХтвгтаОтб▒тгКтвзта│тгЬтб┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тгДтабтаШта┐тбПтбЩта╖твИтаРтаатг╝та╛тг┐тг┐таЙтаДтгита┐тг┐тг┐тг┐тг┐тг┐тг┐тгПтботгХта│таЩта╛тг╖таитгЗтвзтаИтбРтаА",
"таМтаатаБтг╛твптвзтбЫтв┤тбйтвЖта│тгАтвЛтгетг┐тг┐тг┐тг┐тг┐тг╗тгЗтвВтабтбШтаГтаМтаВтвЖтбИтаДтбБтаВтв┐таАтаМта░тг╜тг╝тг╢тг┐тг┐тг┐тг┐тг┐тгЯтглтвЖтабтбЩтбЬтгйтаУтгМтгзтаРтаатвБ",
"тбАтвАтаРтгМтбЯтвзтг╗твжтб▒тгИтаУтв╢тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╖тг┐тг╛таатвИтбРтбИтбИтбДтбИтаАтбДтвБтввта╗твЫта│тгптв┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╖тбОтаФтб▒тбШтвдтвлтгЯтб╛твАтаАтаВ",
"тбРтвАтаВтб╜тв╛тб╣тгМтв╖тг╗тв┤тбйтг┐тг┐тг┐тг┐тг┐тг┐тг┐та┐тг╖тгОтг╗тг╖таЯтб╗таетгЙта┤твбтаКтг┤таетгВта│тг╝таЯта╗таЫтбЫтвЛтв╗тг┐тг┐тг┐тг┐тг┐тг┐таетб▒тгЙтб╛твПтвЫтб╗таАтаМтбА",
"таРтаАтаВтг┐тгМтбЫтбЬтв╢тб╣тв╛тб╜тг┐тг┐тг┐тг┐тг┐тг┐тбЫтвжтвйтаЩтв╖тгжтб╕тгФтгбтвЖтбГтбИтг╛твЙта▓та╝тбЯтбЗтаМтгбтввтг╡тготг╖тг┐тг┐тг┐тг┐тг┐тг┐тгЧтбИтаптвЫтвдтггтвЯтаАтвВтаР",
"таатвАтаРтготгЯта┐тг╝тготб▒тгзтбБтв┐тг┐тг┐тг┐тгЯтв╣тг┐тгжтвзтгЩтвЖтбЫтв│тажтгШтв│тгМтбИтб▓тгзтвКтаФтгбтвШтг┤тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тгЯтбЗтготг╜тгвтгЯтб╛твАтаВтаМ",
"тбБтаВтаМтг┐тг┐тг┐тб┤тгптбХтггтбЭтбБтв┐тг┐тг┐тг┐тгжтб╗тгЬтазтгНтаотгНтвгтаЭтгМтг┐тбзтбИта┐тг╗тв╖тг╛тг╢та┐тгЫтгнтг╢тб╛твЯтвЫта╗тгйтг┐тг┐тг┐тб┐тгЭтбИтвнтбЩтг╖твЯтб┐таАтаМтбА",
"таАтаАтвИтг┐тг┐тг┐тгЯтб╖тв│тбЬтб╗тв╢тбБтгЯта┐тг┐тг┐тг┐тг╢тгптгмтг│тгмтгзтг╛тг┐тбЯтб░тбИта│тбШтбТтвЖтвОтбИтбИтбИтбИтбШтвЖтгйтг╢тг┐тг┐тг┐тбЫтбИтг┤тввтбЮтг╜тгПтгптб╢таБтаАтбР",
"твВтаРтаатантб╗тв┐тг┐тг┐тг╖тгнтбЯтготв╖тбБтбБтгмтг╜тгЫта┐тб┐тв┐та┐тб┐твЯтб╗твЙтбмтгСтвгтбИтбИтбИтбИтгМтбИтбИтггтг╢тг╜та╛тв┐тбЫтвЙтбИтбИтбИтб┐тгмтв╖тг┐тбЯта┐таБтвВтаБтаВтаД",
"таВтаМтаРтбАтаБтамтв╝тг╗тг┐тв╖тг┐тг╡тгжтгНтг╗тбБтбБтбБтбБтбБтбЖтгЩтбРтвгтгОтбИтбИтбИтбИтгЗтбИтбИтгЩтбИтбИтбИтбИтбИтбИтбИтбИтбИтгжтг╜талтбЮтг╖тг╜тг┐тгЫтгатвАтаатаАтаМтаРтбА",
"таАтаАтаРтаатаЙтаДтаАтаатаЩтвЛтаЫта│тг┐тг╝тгЬтгптв╢тг╜тг╣тгЛтг╢тгетбИтбИтбИтбИтбИтбИтбИтбИтбИтбИтбИтгЛтв╢тгПтг┐тг┐тг╜тг╢твотгнтг╢тг┐тг╢тбЩтвГтбАтвБтаИтбБтвВтаБтаАтаАтбР",
"таМтаатвБтаАтаБтаМтбАтвГта╣твЖтаОтб░таПтвВтаЛтв╜тгйтбЙтаЯтг┐тг┐тг╖тг┐тг╛тгНтгптг┤тгНтб╢тг╗тв┐тгЯтгптг┐тб┐та┐твЪтаЮта╣тгЗтаИтабтаТтбАтвКтаБтаЙтаБтаМтбАтвВтаАтаАтаИтаДтабтаА",
"таИтаРтаатаАтаДтаВтаРтвАтаВтаМтаатаСтаИтаДтаатвАтаАтаЙтаЫтбДтвЙтаЫтаЫтаЙтаДтв▓тб╣та╗тг┐тгЭтбЪтаЪтвЙтаЩтавтаМтаатаИтаЛтбРтаКтаДтбРтаАтаВтаДтаатвАтаВтаРтаатаАтаДтбИтаАтаБтвВ",
"тбАтвАтаатаБтаМтбАтвАтаатаИтаДтабтвИтаАтаМтбРтаатвАтаАтбРтвИтаТтбЙтаТтбИтаШтабтаРтбАтвИтаСтавтвБтаИтбБтаРтбИтаДтбБтвВтаАтбБтвВтаРтбАтаАтаМтбРтаатвАтаАтаатвБтаВтаДтбАтвАтаВ",
"таРтбАтвВтаАтаАтбРтвАтаВтбБтаАтаРтаатаИтаДтаАтаАтвВтаРтаатаАтаАтаДтабтвАтаБтаАтаРтбАтаВтаДтаАтаАтаВтаДтабтаАтаАтаРтбАтаВтаДтаАтаРтаатвБтаВтаАтаАтаВтаМтбРтаАтаАтаРтбАтаВтаД",
"таБтаАтаатвИтаРтбАтаАтаРтаатаБтаМтаАтаБтаМтаатвБтаАтвИтаатаБтаМтбАтаБтаАтаМтаатвБтаАтаБтаМтаатвБтаИтаАтабтаИтаДтбБтаАтаБтаМтаатвБтаАтаАтаМтаатвБтаИтаАтаатаБтаМтбАтаАтаБтвВ",
"таатвАтаРтаАтаВтаДтаатаИтаДтабтаИтаДтаатаИтаРтаатаАтаДтвВтаБтаВтаДтаатаРтбИтаРтаатаАтаДтбИтаРтаатаАтаДтаатаБтаВтаДтаатаАтаМтаРтаатаАтаДтбИтаРтаатаАтаДтаатаБтаВтаДтаатвАтаВ"
};

// ьЪй (эФМыаИьЭ┤ьЦ┤ ь║РыжнэД░) ASCII ьХДэК╕ ы░░ьЧ┤
const char* dragon[] ={
"тг┐тг┐тг┐тг┐тг┐тг┐тг╢тгдтбАтбАтаАтаАтаАтаАтаЩта╗тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тв╗тг┐тг┐тг┐тг┐тг┐тг┐тб┐твЯта┐тв┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╢тгЕтбВтбАтаБтаИтвАтаИтаЫтг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╖тв╕та╣тг┐тг┐тг┐тг┐тг╛тгжтгЗтавтаАтаДтаРтаИтаЙтаЩтаЫта┐тв┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╖тгжтвбтбатаАтаАтаВтвАтаЩтв┐тг┐тг┐тг┐тг┐тг┐тгзтбСтаМтбЩта┐тг┐тг┐тг┐тг┐тг╖тббтаАтбБтаИтаДтаБтбАтаВтвАтаИтвЙтаЩта╗тв┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тгзтг╖тбЖтбРтаАтвАтаАтаДтаЩтв┐тг┐тг┐тг┐тг┐тгзтабтаатаАтаЩтв┐тг┐тг┐тг┐тг┐тгЖтаРтаатаАтаБтаДтбРтаАтаатаАтбАтаВтаАтбАтаЩта╗та┐тг┐тг┐тг┐тг┐тг┐тг┐",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тбМтавтбАтбАтаАтвАтаАтаЙта┐тг┐тг┐тг┐тгзтвСтвИтаатаАтаЩтв┐тг┐тг┐тг┐тбМтбВтбВтаДтаАтаАтаЕтбВтаатаАтаРтвАтаАтаатаАтаАтаИтаЫтв┐тг┐тг┐тг┐",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг╖тбБтавтаРтбИтаАтаАтаАтаДтаИта╗тг┐тг┐тгЗтавтаАтвВтаатаАтаЩтв╗тг┐тг┐тб░твРтаРтаИтаАтаАтвАтабтаВтаБтаАтаРтаАтаДтаИтаАтбАтаВтаЩтв┐тг┐",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тгзтабтабтаРтбИтвАтаВтвАтаАтвАтаИтв╗тг┐тбЕтаЕтаДтвАтаАтаДтаАтаЩтв┐тботбВтаМтаМтбАтаБтаАтаАтаИтаитбАтаБтаАтаВтаИтвАтаАтаАтаИтаАтаЩ",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐таДтаЕтаВтбВтаЕтаМтаДтвАтаДтаАтаАтаИтвЗтаХтаатаАтбАтаАтаДтаАтаАтвХтвРтаБтбВтаДтвБтаРтаАтаБтаАтбАтвСтаИтаАтаИтаАтаАтаДтаБтаИтаА",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тбЗтабтабтбВтаЕтаЕтаМтвВтаАтаВтбБтаАтбвтвСтаБтаДтаАтаАтаДтаАтватвГтаВтбВтвРтаАтаВтаатаАтаДтаВтаАтаАтаитаРтаАтаВтаАтаАтаДтаАтаД",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тв┐тг┐тв┐таптб╕таИтвФтаитаатаСтаАтаЕтаРтвАтаАтбАтаАтаИтаАтвИтвАтаатаитаВтбАтбВтбРтаатвАтабтаРтаАтвАтаАтаАтаатаАтаИтвВтаДтаИтаАтвАтаа",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тв┐тгпта╗твЗталтб╕таитаатбСтвРтаитвАтабтаИтвАтаатаИтаАтаАтбАтаитвРтаитвАтаРтаРтбИтаДтаВтаатаАтаВтбАтаАтаатаАтаАтаАтвАтаАтаАтаатаРтаАтаВтбБтвАтаА",
"тг┐тг┐тг┐тг┐тг┐тг┐тг┐тг┐тв┐тбЯта╜тбЙтвСтаИтаатбРтбХтбБтавтб▒таАтвВтаРтбАтаДтаИтвАтаатаИтбРтвАтабтвАтаРтвАтаитаАтаДтаРтаИтаАтаРтаАтаАтаАтаДтаАтаИтаАтаАтаАтаАтаАтаАтбАтаИтаДтбАтаАтаД",
"тг┐тг┐тг┐тг┐тг┐тг┐тв┐тбЙтагтаатаБтаДтаВтаМтбКтбвтбСтбАтаЕтбЗтаАтаВтвВтаРтбИтаатаАтбАтаВтвАтаатаАтаАтаДтаАтбАтаДтаАтаДтаАтаДтаАтаатаРтаАтаАтаатаАтвВтаатбИтвДтвРтаАтаАтбАтаРтаатаАтаА",
"тг┐тг┐тг┐тг┐тб┐тбЭтвТтаатабтвБтаИтаатаИтгВтаРтвРтвРтаАтвВтаЕтвАтаАтаВтаАтвДтаЗтаАтвАтаАтаАтаАтаАтаАтбАтаАтаАтаАтаАтаДтаАтаДтвАтаАтаАтаатбСтбЕтбгтб▒тб░тгМтввтавтббтбБтбВтбВтбБтабтаА",
"тг┐тг┐тб┐тбгтаГтаВтвДтаЕтвВтаМтбМтаФтвИтажтбИтвРтаатаРтбИтаАтаАтаАтвИтввтаЕтаАтаАтаАтбАтаВтаАтаБтаАтаАтаБтаатаАтвАтаАтаВтвАтаатаАтаБтбИтбКтб║тб╕тгктвктбктгктвктввтввтабтбВтббтаБтаА",
"тг┐тг┐тб┐тбБтвВтабтаБтаЕтвФтабтаКтбАтаВтвАтаСта╣тбРтбАтвАтаВтаРтаАтвФтвАтаКтаАтаАтаВтаБтаАтаАтаИтаАтаИтбАтвИтаАтаАтаАтаатаРтаАтаАтаДтаАтаАтаКтаМтаЬтбМтгЗтаптгктб║тбвтб▒тб▒тбРтбРтбБ",
"тб┐тбЫтаатвРтвДтавтвСтаЙтаДтаВтаАтбАтаатаАтаАтвЕтаитгВтаатаАтвБтаитаИтаАтвАтаАтаВтвАтаРтаАтаАтаатаАтвБтвотб▓тбЕтвЕтаВтаАтаатаАтвБтаАтбБтаАтаДтаБтабта╕тбШтвЭтб▓тгХтбЗтгПтвотвКтвЖтаЕ",
"таГтб░табтабтаРтвИтаАтаДтг░тг┤твдтбатвАтаРтаАтбИтаФтаРтаДтаМтвАтаГтаБтбИтаАтаАтвАтаРтбАтаБтаАтаАтаАтавтбйтвгтагтбСтаитаРтаАтаИтбАтвАтаРтаАтаАтаРтаИтавтбАтаДтблтвотб║тб╕тбЬтбОтбЖтбг",
"тбГтбВтвБтвИтв░тбАтбВтг╜тг┐тг┐тгЯтбптгЗтаДтгВтгДтбШтбАтаЕтаЕтбВтаАтаВтаАтаАтаАтаатаРтаАтаИтаАтбАтаВтаИтаДтаЕтавтаитаатвБтаРтаАтаАтбАтвВтаБтаДтаАтаАтаВтвбтвРтвРтгХтгПтгЧтбЭтбОтбктав",
"твЗтаВтбРтбФтбЕтбЗтгЗтв╖тг╗тб╜тгптб╗тбЬтбОтг┐тг┐тг╜тгвтаатаСтаДтаДтбАтгВтввтвВтбвтаатбАтаВтаАтбАтвАтаАтаБтаИтаДтвБтаРтаАтвАтаРтаАтаРтбАтаВтаДтвБтаРтаатвКтвМтб╝тб║тгЬтгЦтвгтагтагтбб",
"твМтвОтвЬтвЬтв╡тв▒тб╣тг║твЭтв╡тв╣тв╕тактб│тг╗тг║твктбгтаЕтаВтбЬтгЬтвЬтвота╖тбптбгтавтабтвАтаРтвАтаКтаАтаРтаИтаАтаАтаАтаВтбАтбвтг╡тгЧтвЭтвМтвДтвРтветвПтботбптглтв║тФетЗЗтагтб▒тбШ",
"тбитаКтвЬтаШтаЬтаотвотв║тбктгзтбгтбгтвгтб▒тбЬтбЬтгЬтвЬтб╝тгмтгитвКтгЖтгЗтгЗтвХтвЕтаКтаЬтвИтаатаРтбАтадтаМтвДтаДтвВтвАтвДтабтвДтаПтботактбктгФтгХтбзтбптгЫтаотбЛтбЬтбМтвОтавтбГтбГтаФ",
"таЕтаМтвДтаЭтвЬтвМтвЖтвЗтаХтвХтазтблтб│тб╣тб╜тгХтв╛тгЭтв┐тв╜тгЮтб│тб╣тбЭтбЮтбХтбХтвХтабтбатб╕тб│тгФтгФтгФтвДтгДтвжтг▓тг│тгктб▓тг╝тб║тгЭтвЮтвЧтбУтбНтбОтбОтбЗтбЗтбгтбгтаГтаХтвРтаатвБ",
"таМтвМтавтвШтаРтвХтвХтвХтаЭтвОтвОтвЮтвОтв║тв╕тв╕твЬтвОтвптвотвотг║твЬтбктбвтгХтгЬтв╝тбктгЦтбптбЧтбЧтгЧтвЭтвЧтв╜тв│тв╡тггтг│тв╣твЬтвОтвОтвЗтбЗтбХтбХтбЭтвШтаМтбОтбвтаВтаЕтббтвВтвКтвА",
"таатббтаитбатвСтвРтвРтвИтаКтбвтбСтвЕтвЗтвЗтбГтбЗтбЗтвзтвгтбгтбгтбЛтбЧтбЭтбЭтбЮтгОтвзтблтботвотблтбЭтбОтбзтблтбСтвХтвСтвТтгВтвЗтветв│та▒тб▒твитвКтаКтбФтб▒тбШтаИтбАтбМтаМтаФтаБтбВтаБ",
"таБтаВтбБтбРтаатаСтбРтвДтаитаатаИтвЖтвКтавтбГтвЗтвФтвЕтаетв▒тв▒таСтвХтв▒таитбМтбМтаЬтвМтактбвтгВтвгта▒таСтаМтбОтбвтбктб▒тбРтаЕтагтвбтбРтвМтватвРтактвИтаВтавтвСтаСтаитаАтаЕтаВтаФтаИ",
"таАтабтаРтаАтабтвВтаитвАтаРтаитвИтаатвВтаСтбСтаДтвЕтагтббтбВтабтабтбСтаФтгЕтввтвбтвбтабтбКтбТтвМтвВтвХтвХтв╣твШтаЬтвМтаЖтаЖтвОтактабтвКтаВтавтаитбРтаФтаитаКтбАтаДтаЕтбБтвИтаАтбВтаб",
"тбКтбАтаВтаРтбАтаРтаитаатбИтаМтбАтвВтаБтаФтаИтаМтбРтвАтаВтаМтбСтаЕтбВтаСтаДтаМтбИтвМтвМтавтаКтаТтаРтбБтвВтаРтаДтаЕтабтаИтаМтаатаАтабтаатаитаитаИтбАтбВтаЕтбвтаВтвБтабтвИтаАтбРтаАтаВ",
"тгзтаРтвИтвАтаатаИтаатаБтавтбАтбВтаДтвВтвБтаАтаБтаРтаатвАтаВтаатабтаитаИтаДтаЕтаИтаатаАтбИтаатаБтбБтаДтаВтаМтбРтаатабтвСтвИтаВтбКтаМтаитаИтаДтабтаАтбАтаВтаатаАтаДтаВтаАтаДтаатаИтбА",
"тг┐тбДтаРтаатвАтаВтаРтаАтаРтаАтаВтбБтаВтаДтаКтаатабтаИтаАтбИтаитаАтбИтаИтбИтаитвИтвРтаАтаВтаВтвБтаРтаАтаБтаатаАтаРтаАтаАтаАтбАтвАтаАтвБтаатаИтаАтаЕтаАтаВтабтвАтаРтбАтаВтаМтаАтаДтаА",
};

// ь┤Э (ым┤ъ╕░) ASCII ьХДэК╕ ы░░ьЧ┤ (ьВмьЪйыРШьзАыКФ ьХКьЭМ, ь╢ФэЫД ъ╕░ыКе ь╢Фъ░АьЪйьЭ╕ ыУп)
const char* gun[] ={
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтвАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбДтгДтаДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтввтвБтвАтвжтввтвжтвжтватбатбвтаатбАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбАтгдтг│таЛтаЙтаИтаЕтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбАтбВтгктв║таитавта▒тв▒таСтаХтаатаАтаАтаИтаИтаВтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтбАтбРтбЬтгЬтвЮтбДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтбАтвДтвВтввта▓тбЭтбОтбЗтбНтбКтвОтбШтбмтаитаИтаДтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтвАтввтв▒тв▒тв╜тг╡тв▒таСтаДтаДтвДтаАтаАтаАтвАтаатаатаАтбАтавтаитбВтбЗтб│та▒тббтгСтвЕтаСтвЬтвМтвЦтбЬтб╡тббтв▒таАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаатбРтгФтв╡тб▒тгЭтб╜тг║тб│тбетббтб▒тбатббтбСтбРтбРтаДтвХтаФтвМтвКтвКтвМтбЦтгЬтботгЮтботгктбктг│тв│тв╡твХтбзтбгтбктбЗтбДтбАтаАтаАтаА",
"таАтаАтаАтаАтвИтввтвХтвОтботг│тб╗тг║тбктбгтблтгЮтб╖тг╡тв╡тв╡тгХтгХтв╝твмтгатв▒та▒тбХтгЧтг╜тгЮтвптгктвУталталтблтбХтв╡твХтбптгЮтв╡тб╕тб╕тбатаСтаДтаАтаА",
"таАтаАтаАтаАтбРтб▒тб╡тгПтгЮтвзтвПтбЧтб╡тгЭтб╜тб╜тгЭтв╜тг╗тв╜тв╛тв╛тг╜тг╡тг│тгптвЧтгЭтв╡твЧтбЧтб╡тбБтаВтаЕтвЕтвСтвЭтвХтбЗтбПтбЧтбХтаЭтбОтбОтбАтаитаАтаА",
"таАтаАтаАтгАтввтблтгЧтвХтвЗтвЧтв╜тв▒тв▒твктвктвлтвктвктвктв╣тв╣тв╜тб╜тгптб╖тг┐тгЭтвотблтгЮтвМтаЗтаЖтаАтаАтаАтаВтбЗтаВтаСтаРтаШтвФтаЗтаИтактбЖтбВтаАтаА",
"таАтаАтвАтвЪтвЬтвЬтвотб│тггтвлтвЧтвХтвХтвХтаХтбХтбХтбХтбХтгХтв╜тв╜тг╗тв┐тгЭтб╖тб╣тб╕тгПтвОтаОтгЬтаДтаАтаАтаАтаАтбЗтаАтаАтаАтаАтаВтвптаАтаАтаАтаАтаАтаА",
"таАтаАтаРтбХтбХтг╜тбЭтбОтботб║тгХтвХтвХтвХтвХтвХтв▒та▒таСтбЕтбптг╗твЭтгЧтб╖тб╜тбШта╛тгХтвЗтв│твптгктавтбАтаАтвАтвГтвАтвАтаАтаАтаИтаИтаАтаАтаАтаАтаАтаА",
"таАтаАтв░тв▒тв▒тб│тбЭтбЬтбЬтгЬтвотбатгЗтвЗтаЗтаГтаБтаатб▒тг╕твЭтгЮтгзтв╗тгЮтв┐тб╜тг╡твитбВтбАтаБтаЛта│та▒та╡тгФтб╡тбХтвНтаВтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтвАтвктввта▒тб╕тбХтвХтвХтвХтв╡твЭтвЬтаЬтаАтаАтаАтажтвотбЗтгптг╛твптг│твзтг╖тб╗тбЪта│тб│тгМтвЖтаДтаАтаитаИтаБтаАтвЭтаЖтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтв░та▒тбСтбСтб╜тб╕тб░тб▒тб▒тб▒тгЭтвОтаОтаАтаАтаМтгЭтвЬтг╜тг╜тг╗тг╜тг║тв╜тбктбАтватватвАтв▒твлтб│тгДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таРтбЬтвМтактбктб║тб╕тб╕тб╕тб╕тб╕тб╕тгХтвЗтаАтаатаСтгХтвЭтгЮтгптв╗тбЧтаУта│таЩтаотаУтаЙтаРтвАтвПтаЧтгЯтаДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таитбШтаФтаХтвМтактб│тбЭтб╝тг╕тв╕тб╕тг╕тб▓тгДтаАтватв│твПтв╛тбЗтбЧтбХтаАтаАтаАтаАтаАтаАтаАтаИтаШтаБтаПтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таитбктаИтаИтаАтаСтвНтв╖тггтаГтбЧтаБтаАтаИтаШтаХтажтг╕тв╣твотб╗тбЬтбМтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтбЗтаАтаАтаАтаАтаАтаЩтботбДтаЕтаАтаАтаАтаАтаАтаАтаАтаИталтгЮтгЧтбХтбЕтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАта▒таАтаАтаАтаАтаАтаАтаИтвЧтбЕтаАтаАтаАтаАтаАтаАтаАтаАтаБтаЩтвотгЧтбЗтбЗтаДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаБтаатабтбБтавтвРтаатбИтбЪтвжтбАтаАтаАтаАтаАтаАтаАтаАтаДтаЕтаУтвПтвптвзтвзтввтаРтаДтвХтвАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтвАтаАтаМтавтаитбИтавтбСтбРтвМтавтбБтбГтбВтаАтаАтаАтаАтаАтаАтабтвСтвРтаРтбФтаХтаНтбМтвОтвОтвЖтвЕтаРтвАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаИтаАтаИтаРтаМтаВтаВтаЕтаЕтагта▒тб▒тгМтбЖтбДтаЕтаЕтбАтаАтаАтаАтаАтаСтаИтаИтаАтаИтвДтаЕтвХтвХтвХтвРтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаИтаВтаБтаБтаАтаАтаАтаАтаАтвБтаГтбЛтгЯтвХтвЗтвЧтвжтаВтаАтаАтаАтаАтаАтаАтаАтаИтаАтаАтаРтаБтбЗтбЖтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаСтаРтаСтаЙтагтбЗтбЕтбХтбдтгАтаАтаАтаАтаАтаАтаАтаАтаАтбАтгФтв╝та▒таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаИтаЩтаШтаЪта╢та▓твФтвЖтвЧтаХтаХтаБтаБтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
};

// ьЧмьЭШьг╝ ASCII ьХДэК╕ ы░░ьЧ┤
const char* Orb[] = {

"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтвАтбдтгФтб▓твотб╣тгНтвПтбЧтг│тв▓тбдтгДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтвАтб┤тгКтвПта╢тгбтвЫтвжта│тбЬтгОтаЮтгетбУтбЮтгнтгЫта╢тгДтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтг░твлта┤тбЙтвМтввта▒тгНтв▓тб╣тбЬтгмтвЫтб┤тб╣тгЬтб▒тгОтвЯтб╝тг│таДтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтвАтбЮтбетгУтавтгЙтаЖтбОтб╡тгКтвзтб▒тгЩтвжтгЛта╢тб▒твОтб╡твктвПтб╛тг▒тв╗тгДтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтбЬтвотб▒твОтб╡твКтб╝тв▒тб▒тбНтв╢тб▒тгНта╢тгйтвЮтб▒твлтб╝тгЩтвотб╡тглтвЧтб╛тбДтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтв░тгЛтвзта│тгНта╢тгйтаЮтб▒твОтбЭтвжта│тгмтв│тб▒твОтбЭтггтаЮтгетв│тб║тг╡твлтбЮтг╖таАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтв╕тбнтвОтб│тгмта│тгетвлтбХтглтбЬтггтгЫта┤тггтбЭтб║тбЬтгета╗тгЬтггта╖тгнтв│тг╗тг╝таАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтв╕твзтвлтб╡тгКта╖тгмта│тб╝тг▒твЪтб╡твктбЭтв╢тбйтвЧтб╣тб╝тгЩта╛тг╝тб╣тгОтгптвЧтб╛таАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаШтгПтв╖тгЪтбнтбЮтгетбЫтв╢тгЩтвотбЬтвзтбЭтботв╡тгЛтв╖тб╣тгнтгЫтв╢тг╣тв│тботгЯтбЮтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАта╣тгОтв╖тб│тгЭтв╢тг╣твгтгПтв╢тб╣твЮтб╝тгЩтвзтбЭтготв│твзтгЫтготв╜тг│тв╗тб╝таБтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаЫтготб│тгЭтготв│твптбЬтготв│тгПтв╛тгЩтвотгЭтвотгЫтботв╖тгЪтгпта╛тб╜таБтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаШта╜тг│твЮтб╜тготгЭтвотбЧтготб│тг╜тгЪтготвптг│твЯтгпта╜тготаЛтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаЙта║тв╜тгЦтвптг│твптг│тб╜твзтгЯтвотбЯтг╡тг╗таЮтбЛтаДтгАтаАтбАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаБтаВтаМтаЛтаУтапта│та┐та╜таЪтаЫтвЪтабтаГтаЬтаАтаГтаАтаВтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"                                                              "
};

// ы╢АьДЬьзД ьЧмьЭШьг╝ ASCII ьХДэК╕ ы░░ьЧ┤
const char* brokenOrb[] = {
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтгАтгАтбАтаАтаАтаАтгатгАтгДтбАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтгатбдтв╛тб╣твнтглта╜тгДтаАтаАтг╜тг┐тб╝тг╣твЫтб╢тгДтбАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтгатбЮтвзтбЙтвзтб╣тв│тбмтгЫтв╛тбАта░тг┐тб╜тг╖твнтгЫтб╝тв│тг╗твжтбАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтгатбЮтвзтбЩтвдтбШтб╢тгЩтазтбЮтгнтвЮтбЗтаАта╕тг┐тг╜тботг╡тгЛтв╖тб╣тгЮтв┐тгДтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтгатвЯтб╝твгтбЬтгжтвЫтб╡твнтгЪта╜тг▓тантбЗтаАтаАтг┐тгЮтг╖твгтгЮтггтвЯтб╝тгПтб┐тгжтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтватбЯтгОтбТтвптбЬтгЦтглтбЬтб│твОтгЫтбЦтвптбЗтаАтаАтг┐тгЮтгптв│твОтгзтв╗тб╝тглтг╜тг╗тбДтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтв╕тгЭтб▓тбЭтбзтвЮта╢тг▒таЮтгнтгЫтб╝тгЪтб│тбЖтаАтаАтг┐тгЮтгптгПтб╛тгЬтгзтгЫтб╖тгптв╖тбЧтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтб┐тгЬтгзтг┐тг╛твптг┐тг╛тг┐тг╢тг┐тг╛тг╖тб┐таГтаАтаАта╖таЫта╗та┐таЯта┐та┐тв┐тг┐тг┐тб┐та┐таАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаЩтаЫтаЫта│таЫтаЙтаБтаИтаБтаАтаАтаАтаАтаАтаАтаАтаАтаАтгАтгдтгатгДтгАтгАтгАтаИтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтгАтгатгдтб┤тв╢тг║тв╗твнтбЫтгЯтб╗тгЫтбЯтбЗтаАтаАтг┐тг┐тгПта╖тгнтвптгЭтвптгЯтб┐тг╖тбДтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтгЯтб│твотбЭтгзтв│тбПтгЮтб╣тв╢тб╣тг╡тгЪтбЗтаАтаАтг┐тг╜твОтб┐тгЬтг│тгЮтг╗тв╛тг╜тг│таГтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаШтгЯтгпта╛тг╡твлтбЮтг╡твлтв╖тб╣тгЦтб╜тбЖтаАтв░тг┐тг╜тб║тг╡тглтгЮтб╛тг╜твптгЮтаГтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаШтвптгЯтг╛тв│тг╗тг╝твлтгЮтб╡тгПтг╛таЗтаАтг╛твптг╖тг╗тг╡тг╗тв╛тб╜тгпта┐таГтаАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаЩта╛тгптб╖тгптгЯтг╛тг│тб╜тбОтаАтв░тг┐тгЯтг╛тг│твптгЯтгптаЯтаЛтвАтаАтбАтаАтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаатаРтватаЫта│та┐тгЮтг╖тб┐таБтбДтв╗тг┐тб╛тг│та┐твЫтайтвВтаЬтбИтаЖтаТтвАтаБтаАтаАтаАтаАтаАтаА",
"таАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаИтаАтаБтаАтаАтаАтаБтаАтаБтаАтаРтаАтаРтаИтаАтаБтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаАтаА",
"                                                              "
};

// ASCII ьХДэК╕ые╝ ь╢ЬыаеэХШыКФ эХиьИШ
void printArt(const char* art[], int lineCount) {
    for (int i = 0; i < lineCount; i++) {
        // art ы░░ьЧ┤ьЭШ ъ░Б ым╕ьЮРьЧ┤ьЭ┤ ы╣ДьЦ┤ьЮИьзА ьХКьЭА ъ▓╜ьЪ░ьЧРызМ ь╢Ьыае
        if (art[i] && strlen(art[i]) > 0) {
            printf("%s\n", art[i]);
        }
    }
}

// ьКдэЖаыжм ьЮмьГЭ эХиьИШ (ъ╡мьб░ь▓┤ ьВмьЪй ьХИэХи)
void playStory(const char** arts[], const int art_lines[], const char* texts[], int frameCount) {
    struct termios oldt, newt;
    // эВд ьЮЕыаеьЭ┤ ы░ФыбЬ ы░ШьШБыРШыПДыбЭ эД░ып╕ыДР ьДдьаХ ы│Аъ▓╜
    tcgetattr(STDIN_FILENO, &oldt); // эШДьЮм эД░ып╕ыДР ьДдьаХ ъ░Аьа╕ьШдъ╕░
    newt = oldt; // эШДьЮм ьДдьаХ ы│╡ьВм
    newt.c_lflag &= ~(ICANON | ECHO); // ьаХъ╖Ь(ICANON) ыкиыУЬ ы░П ьЧРь╜Ф(ECHO) ы╣ДэЩЬьД▒эЩФ
    tcsetattr(STDIN_FILENO, TCSANOW, &newt); // ьГИ ьДдьаХ ьаБьЪй

    for (int i = 0; i < frameCount; i++) {
        // 1. эЩФый┤ ьаДь▓┤ые╝ ьзАьЪ┤ыЛд.
        printf("\033[2J");
        
        // 2. ь╗дьДЬые╝ ызи ьЬД(1,1)ыбЬ ьШоъ╕┤ыЛд.
        printf("\033[1;1H");

        // 3. эШДьЮм эФДыаИьЮДьЭШ ьВ╜эЩФые╝ ь╢ЬыаеэХЬыЛд.
        if (arts[i] != NULL) { // ьВ╜эЩФъ░А ьЮИыКФ ъ▓╜ьЪ░
            printArt(arts[i], art_lines[i]); // ьВ╜эЩФ ь╢Ьыае
            printf("\n"); // ьВ╜эЩФьЩА ыМАьВм ьГБьЮР ьВмьЭ┤ьЧР эХЬ ьдД ъ│╡ы░▒ ь╢Фъ░А
        } else { // ьВ╜эЩФъ░А ьЧЖыКФ ъ▓╜ьЪ░
            // ыМАьВмые╝ эЩФый┤ ьдСьХЩьЧР эСЬьЛЬэХШъ╕░ ьЬДэХ┤ ь╗дьДЬ ьЭ┤ыПЩ
            printf("\033[11;1H"); // 11эЦЙ 1ьЧ┤ыбЬ ь╗дьДЬ ьЭ┤ыПЩ (ыМАыЮ╡ ьдСьХЩ)
        }

        // 4. ыМАьВм ьГБьЮРые╝ ъ╖╕ыж░ыЛд.
        printf(" %-75s \n", texts[i]); // ыМАьВм ь╢Ьыае (75ь╣╕ ьЩ╝ьк╜ ьаХыам)

        
        // 5. ь╢Ьыае ы▓ДэН╝ые╝ ы╣ДьЫМ эЩФый┤ьЧР ьжЙьЛЬ эСЬьЛЬ
        fflush(stdout);
        
        // 6. ыЛдьЭМ ьЮеый┤ьЬ╝ыбЬ ыДШьЦ┤ъ░Аъ╕░ ьаД ьЮаьЛЬ ыМАъ╕░
        sleep(STORY_DELAY); // ьаХьЭШыРЬ STORY_DELAY ызМэБ╝ ыМАъ╕░
    }
    
    // ызИьзАызЙьЧР ьВмьЪйьЮР ьЮЕыае ыМАъ╕░
    printf("\n(ъ│ДьЖНэХШыадый┤ ьЧФэД░ые╝ ыИМыЯмьг╝ьД╕ьЪФ)");
    fflush(stdout);
    // ы▓ДэН╝ьЧР ыВиьХДьЮИьЭД ьИШ ьЮИыКФ ым╕ьЮРые╝ ы╣ДьЪ░ъ│а ьЮЕыаеьЭД ъ╕░ыЛдыж╝
    while(getchar() != '\n' && getchar() != EOF); // Enter эВдъ░А ыИМыжмъ▒░ыВШ эММьЭ╝ ыБЭьЧР ыПДыЛмэХа ыХМъ╣МьзА ы▓ДэН╝ ы╣ДьЪ░ъ╕░
    getchar(); // ь╡ЬьвЕьаБьЬ╝ыбЬ Enter эВд ьЮЕыае ыМАъ╕░

    // эД░ып╕ыДР ьДдьаХьЭД ьЫРыЮШыМАыбЬ ы│╡ъ╡м
    tcsetattr(STDIN_FILENO, TCSANOW, &oldt); // ьЫРыЮШ ьДдьаХьЬ╝ыбЬ ы│╡ъ╡м
}

int main(void) {

    // --- ьШдэФДыЛЭ ьКдэЖаыжм ыН░ьЭ┤эД░ ---
    const char** intro_arts[] = { // ьВ╜эЩФ ы░░ьЧ┤
        dragon, dragon, dragon, NULL, dragonBoss, dragonBoss, dragonBoss, dragonBoss,
        dragonFight, dragonFight, dragonFight, dragonBoss, NULL, NULL, NULL
    };
    const int intro_art_lines[] = { // ъ░Б ьВ╜эЩФьЭШ ыЭ╝ьЭ╕ ьИШ ы░░ьЧ┤
        sizeof(dragon)/sizeof(dragon[0]), sizeof(dragon)/sizeof(dragon[0]), sizeof(dragon)/sizeof(dragon[0]), 0, // NULL ьВ╜эЩФыКФ 0 ыЭ╝ьЭ╕
        sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]),
        sizeof(dragonFight)/sizeof(dragonFight[0]), sizeof(dragonFight)/sizeof(dragonFight[0]), sizeof(dragonFight)/sizeof(dragonFight[0]),
        sizeof(dragonBoss)/sizeof(dragonBoss[0]), 0, 0, 0
    };
    const char* intro_texts[] = { // ъ░Б ьЮеый┤ьЧР ыМАэХЬ эЕНьКдэК╕ ыМАьВм
        "ыи╝ ьШЫыВа, ыУЬыЮШъ│дыУдьЭ┤ эПЙэЩФыбнъ▓М ьВ┤ьХДъ░АыКФ ь▓Ьъ│╡ьЭШ ыСеьзАъ░А ьЮИьЧИыЛд.",
        "ъ╖╕ъ││ьЭА ьЩ╕ы╢АьЭШ ъ░ДьДн ьЧЖьЭ┤ ыУЬыЮШъ│дыУдьЭ┤ ьХМьЭД ыВ│ъ│а эВдьЪ░ыКФ ьЛаьД▒эХЬ ьЮеьЖМьШАыЛд.",
        "ъ╖╕ъ││ьЧРыКФ ьХДьзБ ьЦ┤ыж░ ыУЬыЮШъ│д ъ│дъ│╝ ъ╖╕ьЭШ ьЦ┤ып╕, ъ╖╕ыжмъ│а ъ│з эГЬьЦ┤ыВа ыПЩьГЭыУдьЭШ ьХМьЭ┤ ьЮИьЧИыЛд.",
        "ъ╖╕ыЯмыНШ ьЦ┤ыКРыВа...",
        "ьШдыЮЬьЮаьЧРьДЬ ъ╣иьЦ┤ыВЬ ъ│аыМАьЭШ эММый╕ьЮР 'эШ╝эЕМьЭ╝'ьЭ┤ ыВШэГАыВмыЛд.",
        "ъ╖╕ыКФ ыБЭьЧЖыКФ эЧИъ╕░ьЩА эГРьЪХьЬ╝ыбЬ ыи╣ьЮЗъ░РьЭД ь░╛ьХД ьД╕ьГБьЭД ыПМьХДыЛдыЕФыЛд.",
        "ъ╖╕ьЭШ ы░Ьъ╕╕ьЭ┤ ыЛ┐ыКФ ъ││ызИыЛд ьГЭыкЕьЭА ьВмыЭ╝ьзАъ│а, эПРэЧИызМьЭ┤ ыВиьХШыЛд.",
        "ъ╖╕ыЯмыЛд ъ▓░ъ╡н... ъ╖╕ыКФ ь▓Ьъ│╡ьЭШ ыСеьзАые╝ ы░Ьъ▓мэЦИыЛд.",
        "ьЦ┤ып╕ ыУЬыЮШъ│д: тАЬъ│д, ьИиьЦ┤ьЮИьЦ┤ыЭ╝.. ьаИыМА ьЫАьзБьЭ┤ый┤ ьХИ ыП╝тАЭ",
        "ьЦ┤ып╕ ыУЬыЮШъ│дьЭА ъ│дьЧРъ▓М ызИьзАызЙ ыЛ╣ы╢Аые╝ ыВиъ╕░ъ│а эШ╝эЕМьЭ╝ъ│╝ ызЮьДЬ ьЛ╕ьЫаыЛд.",
        "эХШьзАызМ ьЦ┤ып╕ыУЬыЮШъ│дъ│╝ эШ╝эЕМьЭ╝ьЭШ эЮШьЭШ ь░иьЭ┤ыКФ ыДИым┤ь╗╕ъ│а, ьЦ┤ып╕ыУЬыЮШъ│дьЭА ьУ░ыЯмьбМыЛд.",
        "эШ╝эЕМьЭ╝ьЭА ыСеьзА ьХИьЭШ ьХДьзБ ы╢АэЩФэХШьзА ык╗эХЬ ьХМыУдьЭД ыи╣ьЦ┤ь╣ШьЪ┤ эЫД ыЦаыВмыЛд.",
        "ъ╖╕ ыкиыУа ъ▒╕ ьзАь╝Ьы┤РьХ╝ызМ эЦИыНШ ъ│дьЭА, ьб░ьЪйэЮИ ьИиьЭД ьг╜ьЭ╕ ь▒Д ык╕ьЭД ыЦиьЧИыЛд.",
        "ыкиыУа ъ▓ГьЭ┤ ым┤ыДИьзД ъ╖╕ ьИЬъ░Д, ьЮСьЭА ыУЬыЮШъ│д ъ│дьЭШ ызИьЭМ ьЖНьЧФ ы│╡ьИШьЭШ ы╢ИьФиъ░А эФ╝ьЦ┤ьШмыЮРыЛд.",
        "ъ╖╕ыжмэХШьЧмтАж ьЦ┤ыж░ ыУЬыЮШъ│дьЭШ ы│╡ьИШьЭШ ьЧмьаХьЭ┤ ьЛЬьЮСыРШьЧИыЛд.",
    };
    int intro_frameCount = sizeof(intro_texts) / sizeof(intro_texts[0]); // ьКдэЖаыжм эФДыаИьЮД ъ░ЬьИШ
                                     // --- ьКдэЖаыжм ьЮмьГЭ ---
    
    sleep(1); // 1ь┤И ыМАъ╕░
    playStory(intro_arts, intro_art_lines, intro_texts, intro_frameCount); // ьШдэФДыЛЭ ьКдэЖаыжм ьЮмьГЭ

    char map_backup[ROW][COL]; // ь┤Иъ╕░ ыз╡ ьГБэГЬые╝ ы░▒ьЧЕэХа ы░░ьЧ┤
    // ыйФьЭ╕ ыз╡ (ызИьЭД) ьаХьЭШ
    char map[ROW][COL] = {
        "1111111111111111111111111111111111111111", // 1: ы▓╜/ыВШым┤, m: ьГБьЮР (ьЭ┤ыПЩ ы╢Иъ░А)
        "1mmm000000000000000000000000000000000001", // 0: ы╣И ъ│╡ъ░Д, 7: ы│┤ьКд ыНШьаД ьЮЕъ╡м
        "1m7m000000000000000000000000000000000001",
        "1mmm000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "100000000000000000000000000000000000mmm1",
        "100000000000000000000000000000000000m4m1", // 4: ыНШьаД 2 ьЮЕъ╡м
        "100000000000000000000000000000000000mmm1",
        "100000000000000z0000000c0000000000000001", // z: ым╝ьХ╜ ьГБьаР, c: ь╣┤ьзАыЕ╕
        "1000000000000000000000000000000000000001",
        "1mmm000000000000000000000000000000000001",
        "1m5m000000000000000000000000000000000001", // 5: ыНШьаД 3 ьЮЕъ╡м
        "1mmm000000000000000n00000000000000000001", // n: NPC
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "100000000000000000000000000000000000mmm1",
        "100000000000000000000000000000000000m3m1", // 3: ыНШьаД 1 ьЮЕъ╡м
        "100000000000000000000000000000000000mmm1",
        "1111111111111111111111111111111111111111"
    };
    // ыНШьаД 1 ыз╡ ьаХьЭШ (ыкмьКдэД░ ьКдэП░ ьЬДь╣Ш ыУ▒)
    char map1[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901", // 9: ызИьЭД ъ╖АэЩШ ьзАьаР
        "1111111111111111111111111111111111111111"
    };
    // ыНШьаД 2 ыз╡ ьаХьЭШ
    char map2[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };
    // ыНШьаД 3 ыз╡ ьаХьЭШ (эЮИыУа ыНШьаД ьЮЕъ╡м эПмэХи)
    char map3[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000600001", // 6: эЮИыУа ыНШьаД ьЮЕъ╡м (ьЧ┤ьЗа эХДьЪФ)
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };
    // ыНШьаД 4 ыз╡ ьаХьЭШ (эЮИыУа ыНШьаД)
    char map4[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000501", // 5: ыНШьаД 3ьЬ╝ыбЬ ыПМьХДъ░АыКФ ьЮЕъ╡м (ъ░АьаХ)
        "1111111111111111111111111111111111111111"
    };
    // ыНШьаД 5 ыз╡ ьаХьЭШ (ь╡ЬьвЕ ы│┤ьКд ыНШьаД)
    char map5[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };

    // int playerX = 1, playerY = 18; // эФМыаИьЭ┤ьЦ┤ ь┤Иъ╕░ ьЬДь╣Ш (ьаДьЧн ы│АьИШыбЬ ьДаьЦ╕ыРи)
    int npcX = 19;  // NPCьЭШ X ьвМэСЬ
    int npcY = 12;  // NPCьЭШ Y ьвМэСЬ
    int fire_dx = 1, fire_dy = 0; // эММьЭ┤ьЦ┤ы│╝ьЭШ ь┤Иъ╕░ ы░ЬьВм ы░йэЦе (ьШдые╕ьк╜)
    char* currentMapName = "ызИьЭД"; // эШДьЮм ыз╡ ьЭ┤ыжД
    int gold = 1000; // ь┤Иъ╕░ ъ│иыУЬ
    int potion1_hp = 0; // эХШъ╕Й ым╝ьХ╜ ъ░ЬьИШ
    int potion2_hp = 0; // ьдСъ╕Й ым╝ьХ╜ ъ░ЬьИШ
    int potion3_hp = 0; // ьГБъ╕Й ым╝ьХ╜ ъ░ЬьИШ
    int playerHP = 100; // эФМыаИьЭ┤ьЦ┤ эШДьЮм ь▓┤ыае
    int playerMaxHP = 100; // эФМыаИьЭ┤ьЦ┤ ь╡ЬыМА ь▓┤ыае
    int a=0; // ыНШьаД 5(ы│┤ьКдыз╡)ьЧР ьзДьЮЕ ьЛЬ ьКдэЖаыжм эК╕ыжмъ▒░ые╝ ьЬДэХЬ ы│АьИШ
    memcpy(map_backup, map, sizeof(map)); // ь┤Иъ╕░ ыз╡ ьГБэГЬые╝ ы░▒ьЧЕ
    enableRawMode(); // эД░ып╕ыДР ьЫРьЛЬ ыкиыУЬ эЩЬьД▒эЩФ

    // ыйФьЭ╕ ъ▓МьЮД ыгиэФД (ъ▓МьЮД ьЮмьЛЬьЮСьЭД ьЬДэХ┤ ьЩ╕ы╢А ыгиэФД ь╢Фъ░А)
    while (1) {
        // ыНШьаД 5(ы│┤ьКдыз╡)ьЧР ыУдьЦ┤ъ░ФьЭД ыХМ ьКдэЖаыжм ы░П ыжмьЕЛ ыбЬьзБ
        if (a==32){ // эК╣ьаХ ъ░Т (ьЭ┤ьаДьЧР ьКдэЖаыжм ьЮмьГЭ эЫД a++ ыбЬ 31ьЭ┤ ыРШьЧИъ│а, ыЛдьЛЬ ьЭ┤ ыгиэФДые╝ ыПМ ыХМ 32ъ░А ыРи)
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("тЪл ь╡ЬьвЕ ыНШьаД 5ьЧР ьЮЕьЮеэХШьЕиьК╡ыЛИыЛд...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000); // 1ь┤И ыМАъ╕░
            memcpy(map, map5, sizeof(map)); // ыз╡ьЭД ыНШьаД 5 ыз╡ьЬ╝ыбЬ ы│Аъ▓╜
            playerX = 1; // эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш ь┤Иъ╕░эЩФ
            playerY = 18;
            currentMapName = "ыНШьаД 5 (ь╡ЬьвЕ ы│┤ьКд)"; // эШДьЮм ыз╡ ьЭ┤ыжД ы│Аъ▓╜
            monsterCount = 0; // ыкмьКдэД░ ь┤Иъ╕░эЩФ
            spawnMonster(20, 10, 4); // эШ╝эЕМьЭ╝ (ы│┤ьКд) ыкмьКдэД░ ьГЭьД▒
            a++; // ьКдэЖаыжм эК╕ыжмъ▒░ ы│АьИШ ьжЭъ░А
        }
        if (a==31){ // ьКдэЖаыжм ьЮмьГЭ эЫД эФМыаИьЭ┤ьЦ┤ ы╢АэЩЬ ыбЬьзБ
            printf("\033[H\033[J"); // эЩФый┤ ьзАьЪ░ъ╕░
            printf("\n\n\n\n\n");
            printf("------------------------------------------------------- \n\n");            
            printf("              ы│┤ьКдьаДьЭД ьЛЬьЮС эХйыЛИыЛд.  \n");
            printf("-------------------------------------------------------\n");
            printf("\n\n          ьХДым┤ эВдыВШ ыИМыЯм ьЮмьЛЬьЮСэХШьД╕ьЪФ...\n");
            fflush(stdout);
            getch(); // эВд ьЮЕыае ыМАъ╕░
            resetGame(&playerX, &playerY, &playerHP, &playerMaxHP, &currentMapName, map, map_backup); // ъ▓МьЮД ьГБэГЬ ь┤Иъ╕░эЩФ (ызИьЭДыбЬ ы│╡ъ╖А ыУ▒)
            a++; // ьКдэЖаыжм эК╕ыжмъ▒░ ы│АьИШ ьжЭъ░А
            // ьЧмьЭШьг╝ ьХДьЭ┤эЕЬ ь╢Фъ░А
            inventory[0] += 1; // ьЧмьЭШьг╝ ьб░ъ░Б 1ъ░Ь ь╢Фъ░А (ьЭ┤ ы╢Аы╢ДьЭА ыЕ╝ыжмьаБьЬ╝ыбЬ ызЮьзА ьХКьЭМ. 4ъ░Ьые╝ ыкиьХДьХ╝ ьЧмьЭШьг╝ьЭ╕ыН░, 1ъ░ЬызМ ьг╝ыКФ эШХэГЬ)
            inventory[9] = 1; // ьЧмьЭШьг╝ ьХДьЭ┤эЕЬ эЪНыУЭ эФМыЮШъ╖╕ ьДдьаХ (9ы▓И ьЭ╕ыН▒ьКдъ░А ьЧмьЭШьг╝ ьЩДьД▒ ьЧмы╢АьЭ╕ ыУп)
            // ьЧмьЭШьг╝ ьКдэЖаыжм эЫД эФМыаИьЭ┤ьЦ┤ ьЭ┤ыкиьзА ы│Аъ▓╜
            currentEmoji = 1;  // эФМыаИьЭ┤ьЦ┤ые╝ ьЪйьЬ╝ыбЬ ы│Аъ▓╜
            playerEmojis[currentEmoji] = "ЁЯРЙ "; // ьЪй ьЭ┤ыкиьзА ьаБьЪй
            printf("\nЁЯОЙ эФМыаИьЭ┤ьЦ┤ ьЭ┤ыкиьзАъ░А ы▒АьЧРьДЬ ьЪйьЬ╝ыбЬ ы░ФыАМьЧИьК╡ыЛИыЛд!\n");            
        }
        if (a>=1 && a<30){ // ьКдэЖаыжм эК╕ыжмъ▒░ ы│АьИШ aъ░А 1 ьЭ┤ьГБ 30 ып╕ызМьЭ╝ ыХМ ъ│ДьЖН ьжЭъ░А
            a++;
        }
        

        // ъ▓МьЮДьШды▓Д ь▓┤эБм
        if (playerHP <= 0) {
            printf("\033[H\033[J"); // эЩФый┤ ьзАьЪ░ъ╕░
            printf("\n\n\n\n\n");
            printf("------------------- ЁЯТА ъ▓МьЮД ьШды▓Д ЁЯТА ------------------- \n\n");            
            printf("          эФМыаИьЭ┤ьЦ┤ьЭШ ь▓┤ыаеьЭ┤ ыкиыСР ьЖМьзДыРШьЧИьК╡ыЛИыЛд.  \n");
            printf("          ызИьЭДыбЬ ыПМьХДъ░А ьЮмьЛЬьЮСэХйыЛИыЛд...          \n\n");
            printf("-------------------------------------------------------\n");
            printf("\n\n          ьХДым┤ эВдыВШ ыИМыЯм ьЮмьЛЬьЮСэХШьД╕ьЪФ...\n");
            fflush(stdout);
            getch(); // эВд ьЮЕыае ыМАъ╕░
            resetGame(&playerX, &playerY, &playerHP, &playerMaxHP, &currentMapName, map, map_backup); // ъ▓МьЮД ыжмьЕЛ
            continue; // ыйФьЭ╕ ъ▓МьЮД ыгиэФД ыЛдьЛЬ ьЛЬьЮС
        }

        static int firstDraw = 1; // ь▓л эЩФый┤ ъ╖╕ыжмъ╕░ эФМыЮШъ╖╕ (ьВмьЪйыРШьзА ьХКыКФ ыУп)
        printf("\033[2J\033[H"); // эЩФый┤ ьзАьЪ░ъ╕░ ы░П ь╗дьДЬ эЩИьЬ╝ыбЬ ьЭ┤ыПЩ
        // ыз╡ ы▓ФыбА ь╢Ьыае
        printf("ЁЯЯв : ыНШьаД1 ЁЯФ╡ : ыНШьаД2 ЁЯФ┤ : ыНШьаД3 ЁЯЪк : эЮИыУаыз╡ тЪл : ы│┤ьКд ЁЯМА : ызИьЭДъ╖АэЩШ ЁЯПе : ым╝ьХ╜ьГБьаР ЁЯХМ : ь╣┤ьзАыЕ╕ ЁЯдЦ : NPC\n\n");
        printf("\nЁЯМН эШДьЮм ыз╡: [%s]", currentMapName); // эШДьЮм ыз╡ ьЭ┤ыжД ь╢Ьыае
        printf("                                                                            эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш: (%d, %d)\n", playerX, playerY); // эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш ь╢Ьыае

        for (int i = 0; i < ROW; i++) { // ыз╡ ь╢Ьыае
            for (int j = 0; j < COL; j++) {
                if (i == playerY && j == playerX) { // эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш
                    printf("%s", playerEmojis[currentEmoji]); // эФМыаИьЭ┤ьЦ┤ ьЭ┤ыкиьзА ь╢Ьыае
                    continue; // ыЛдьЭМ ь╣╕ьЬ╝ыбЬ
                }
                int fireballHere = 0; // эММьЭ┤ьЦ┤ы│╝ ьб┤ьЮм ьЧмы╢А эФМыЮШъ╖╕
                for (int f = 0; f < MAX_FIREBALLS; f++) { // эММьЭ┤ьЦ┤ы│╝ ьЬДь╣Ш эЩХьЭ╕
                    if (fireballs[f].active && fireballs[f].x == j && fireballs[f].y == i) {
                        printf(fireballs[f].is_monster_bullet ? "ЁЯТз " : "ЁЯФе "); // ыкмьКдэД░ эГДэЩШьЭ┤ый┤ ЁЯТз, эФМыаИьЭ┤ьЦ┤ эММьЭ┤ьЦ┤ы│╝ьЭ┤ый┤ ЁЯФе
                        fireballHere = 1; // эММьЭ┤ьЦ┤ы│╝ ьб┤ьЮм эФМыЮШъ╖╕ ьДдьаХ
                        break;
                    }
                }
                if (fireballHere) continue; // эММьЭ┤ьЦ┤ы│╝ьЭ┤ ьЮИьЬ╝ый┤ ыЛдые╕ ъ▓Г ь╢Ьыае ьХИ эХШъ│а ыЛдьЭМ ь╣╕ьЬ╝ыбЬ
                
                int monsterHere = 0; // ыкмьКдэД░ ьб┤ьЮм ьЧмы╢А эФМыЮШъ╖╕
                for (int m = 0; m < monsterCount; m++) { // ыкмьКдэД░ ьЬДь╣Ш эЩХьЭ╕
                    if (monsters[m].alive && monsters[m].x == j && monsters[m].y == i) { // ыкмьКдэД░ ы│╕ь▓┤ ьЬДь╣Ш
                        printf("%s ", monsterEmojis[monsters[m].type]); // ыкмьКдэД░ ьЭ┤ыкиьзА ь╢Ьыае
                        monsterHere = 1; // ыкмьКдэД░ ьб┤ьЮм эФМыЮШъ╖╕ ьДдьаХ
                        break;
                    }
              
                }
                if (monsterHere) continue; // ыкмьКдэД░ъ░А ьЮИьЬ╝ый┤ ыЛдые╕ ъ▓Г ь╢Ьыае ьХИ эХШъ│а ыЛдьЭМ ь╣╕ьЬ╝ыбЬ

                // ыз╡ ьЪФьЖМ ь╢Ьыае
                if (map[i][j] == '0') printf("   "); // ы╣И ъ│╡ъ░Д
                else if (map[i][j] == '1') printf("ЁЯМ┤ "); // ы▓╜ (ыВШым┤ ьЭ┤ыкиьзА)
                else if (map[i][j] == '2') printf("ЁЯЯе "); // ьЮеьХаым╝ (ы╣иъ░Д ьВмъ░БэШХ ьЭ┤ыкиьзА, ьВмьЪйыРШьзА ьХКыКФ ыУп)
                else if (map[i][j] == '3') printf("ЁЯЯв "); // ыНШьаД 1 ьЮЕъ╡м
                else if (map[i][j] == '4') printf("ЁЯФ╡ "); // ыНШьаД 2 ьЮЕъ╡м
                else if (map[i][j] == '5') printf("ЁЯФ┤ "); // ыНШьаД 3 ьЮЕъ╡м
                else if (map[i][j] == '6') printf("ЁЯЪк "); // эЮИыУа ыНШьаД ьЮЕъ╡м
                else if (map[i][j] == '7') printf("тЪл "); // ы│┤ьКд ыНШьаД ьЮЕъ╡м
                else if (map[i][j] == '9') printf("ЁЯМА "); // ызИьЭД ъ╖АэЩШ ьзАьаР
                else if (map[i][j] == 'z') printf("ЁЯПе "); // ым╝ьХ╜ ьГБьаР
                else if (map[i][j] == 'c') printf("ЁЯХМ "); // ь╣┤ьзАыЕ╕
                else if (map[i][j] == 'n') printf("ЁЯдЦ "); // NPC
                else if (map[i][j] == 'm') printf("ЁЯЯл "); // ьГБьЮР (ъ░ИьГЙ ьВмъ░БэШХ ьЭ┤ыкиьзА)
            }
            printf("\n"); // эХЬ эЦЙ ь╢Ьыае эЫД ьдД ы░Фъ┐И
        }

        // ьГБэГЬь░╜ ьзБьаС ь╢Ьыае ь╢Фъ░А
        printf("тЭдя╕П   HP: %d/%d", playerHP, playerMaxHP); // эФМыаИьЭ┤ьЦ┤ ь▓┤ыае ь╢Ьыае
        printf("                                                                                                       ЁЯТ░ Gold: %d\n", gold); // ъ│иыУЬ ь╢Ьыае

        // тЬЕ эАШьКдэК╕ ь╢Ьыае ь╜ФыУЬ ь╢Фъ░А
        char* questNames[5] = { // эАШьКдэК╕ ьЭ┤ыжД ы░░ьЧ┤
            "ыЛмэМ╜ьЭ┤", "ыПДызИы▒А", "ыПЕъ▒░ып╕", "ыУЬыЭ╝эБШыЭ╝", "эШ╝эЕМьЭ╝"
        };

        // эАШьКдэК╕ ыкйэСЬ ьИШь╣Ш
        int questKillTargets[5] = {10, 10, 10, 1, 1};    // эАШьКдэК╕ ыкмьКдэД░ ь▓Шь╣Ш ыкйэСЬ ьИШ
        int questItemTargets[5] = {5, 5, 5, 1, 1};     // эАШьКдэК╕ ьХДьЭ┤эЕЬ ьИШьзС ыкйэСЬ ьИШ
        char* questItemNames[5] = { // эАШьКдэК╕ ьХДьЭ┤эЕЬ ьЭ┤ыжД ы░░ьЧ┤
            "ыУ▒ъ╗НьзИ",        // ыЛмэМ╜ьЭ┤ ьХДьЭ┤эЕЬ
            "ы╣ДыКШ",          // ыПДызИы▒А ьХДьЭ┤эЕЬ
            "ьЖбъ││ыЛИ",        // ыПЕъ▒░ып╕ ьХДьЭ┤эЕЬ
            "ьЛмьЮе",          // ыУЬыЭ╝эБШыЭ╝ ьХДьЭ┤эЕЬ
            "ьаХьИШ"           // эШ╝эЕМьЭ╝ ьХДьЭ┤эЕЬ
        };

        printf("\nЁЯОп  эАШьКдэК╕ ьзДэЦЙ ьГБэГЬ \n");
        for (int i = 0; i < 5; i++) {
            if (questAccepted[i] && !questCompleted[i]) { // эАШьКдэК╕ ьИШыЭ╜эЦИьзАызМ ьЩДыгМыРШьзА ьХКьЭА ъ▓╜ьЪ░
                printf("  %d. %s: ьзДэЦЙ ьдС... (%d/%d ызИыжм, %s: %d/%d)\n",
                    i + 1, questNames[i],
                    questKillCount[i], questKillTargets[i],
                    questItemNames[i], questItemCount[i], questItemTargets[i]);
            } else if (questCompleted[i] && !rewardGiven[i]) { // эАШьКдэК╕ ьЩДыгМэЦИьзАызМ ы│┤ьГБ ы░ЫьзА ьХКьЭА ъ▓╜ьЪ░
                printf("  %d. %s эАШьКдэК╕ ьЩДыгМыРи! (ы│┤ьГБ ьИШыа╣ ыМАъ╕░ ьдС) ЁЯОБ\n", i + 1, questNames[i]);
            } else if (questCompleted[i] && rewardGiven[i]) { // эАШьКдэК╕ ьЩДыгМэХШъ│а ы│┤ьГБъ╣МьзА ы░ЫьЭА ъ▓╜ьЪ░
                printf("  %d. %s: ьЩДыгМ тЬЕ\n", i + 1, questNames[i]);
            }
        }



        if (questAccepted[0] && !questCompleted[0])
            printf(" "); // эАШьКдэК╕ ьзДэЦЙ ьдСьЭ╝ ыХМыКФ ьХДым┤ъ▓ГыПД ь╢ЬыаеэХШьзА ьХКьЭМ
        else if (questCompleted[0] && !rewardGiven[0]) { // эАШьКдэК╕ 1 ьЩДыгМ (ы│┤ьГБ ып╕ьИШыа╣)
            printf("ЁЯдЦ NPC: тАЬьЮШэЦИыДд. ьЭ┤ъ▒┤ ы│┤ьГБьЭ┤ыДд.тАЭ\n");
            gold += 100; // ъ│иыУЬ ьзАъ╕Й
            inventory[0] += 1; // ьЧмьЭШьг╝ ьб░ъ░Б ьзАъ╕Й
            rewardGiven[0] = 1; // ы│┤ьГБ ьзАъ╕Й эФМыЮШъ╖╕ ьДдьаХ
            printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +100, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
            usleep(1500000);
            playerX = npcX + 1;  // NPC ьШдые╕ьк╜ьЬ╝ыбЬ ъ░ХьаЬ ьЭ┤ыПЩ (NPCьЩА ъ▓╣ь╣ШьзА ьХКъ▓М)
            playerY = npcY;
        }

        if (questAccepted[1] && !questCompleted[1])
            printf(" ");
        else if (questCompleted[1] && !rewardGiven[1]) { // эАШьКдэК╕ 2 ьЩДыгМ (ы│┤ьГБ ып╕ьИШыа╣)
            printf("ЁЯдЦ NPC: тАЬыПДызИы▒Аъ╣МьзА эХ┤ь╣ШьЪ░ыЛдыЛИ! ьЛдыае ьЭ╕ьаХэХШыДд.тАЭ\n");
            gold += 200;
            inventory[0] += 1;
            rewardGiven[1] = 1;
            printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +200, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
            usleep(1500000);
            playerX = npcX + 1;
            playerY = npcY;
        }

        if (questAccepted[2] && !questCompleted[2])
            printf(" ");
        else if (questCompleted[2] && !rewardGiven[2]) { // эАШьКдэК╕ 3 ьЩДыгМ (ы│┤ьГБ ып╕ьИШыа╣)
            printf("ЁЯдЦ NPC: тАЬыПЕъ▒░ып╕ъ╣МьзА эХ┤ь╣ШьЪ░ыЛдыЛИ! ьЛдыае ьЭ╕ьаХэХШыДд.тАЭ\n");
            gold += 1000; // ы│┤ьГБьЭ┤ ь╗дьзР
            inventory[0] += 1;
            rewardGiven[2] = 1;
            printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +1000, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
            usleep(1500000);
            playerX = npcX + 1;
            playerY = npcY;
        }

        if (questAccepted[3] && !questCompleted[3])
            printf(" ");
        else if (questCompleted[3] && !rewardGiven[3]) { // эАШьКдэК╕ 4 ьЩДыгМ (ы│┤ьГБ ып╕ьИШыа╣)
            printf("ЁЯдЦ NPC: тАЬыУЬыЭ╝эБШыЭ╝ ъ╣МьзА эХ┤ь╣ШьЪ░ыЛдыЛИ! ьЛдыае ьЭ╕ьаХэХШыДд.тАЭ\n");
            gold += 2000; // ы│┤ьГБьЭ┤ ыНФ ь╗дьзР
            inventory[0] += 1;
            rewardGiven[3] = 1;
            printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +2000, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
            usleep(1500000);
            playerX = npcX + 1;
            playerY = npcY;
        }
        
        printf("\n\n эПмьЕШ тЦ╢ 1,2,3 эВдыбЬ ьжЙьЛЬ ьВмьЪй \n");
        printf(" ЁЯТЪ эХШъ╕Й : %d ъ░Ь ЁЯТЩ ьдСъ╕Й : %d ъ░Ь ЁЯТЦ ьГБъ╕Й : %d ъ░Ь \n", potion1_hp, potion2_hp, potion3_hp);
        
        char input = getch_nonblock(); // ы╣Ды╕ФыбЬэВ╣ ы░йьЛЭьЬ╝ыбЬ эВд ьЮЕыае ы░Ыъ╕░
        // эММьЭ┤ьЦ┤ы│╝ ы░ЬьВм
        if (input == 'f' || input == 'F') {
            spawnFireball(playerX, playerY, fire_dx, fire_dy, 0, 10); // ъ╕░ы│╕ эММьЭ┤ьЦ┤ы│╝ 10 ыН░ып╕ьзА
        }
        // ыйФэЕМьШд ьКдэВм ы░ЬыПЩ
        if (input == 'R' || input == 'r') {
            castMeteor();
        }

        // ыУЬыЮШъ│д ы╕МыаИьКд ьКдэВм ы░ЬыПЩ
        if (input == 'E' || input == 'e') {
            castDragonBreath(playerX, playerY, fire_dx, fire_dy, 0);
        }

        if (input == 0) { // ьЮЕыаеьЭ┤ ьЧЖьЬ╝ый┤ (0 ы░ШэЩШ)
            updateFireballs(map, &playerHP, &playerMaxHP, playerX, playerY); // эММьЭ┤ьЦ┤ы│╝ ьЧЕыН░ьЭ┤эК╕
            updateMonsters(playerX, playerY, map); // ыкмьКдэД░ ьЧЕыН░ьЭ┤эК╕
            usleep(30000); // 30ms ыМАъ╕░ (эФДыаИьЮД ьЖНыПД ьб░ьаИ)
            continue; // ыгиэФДьЭШ ыЛдьЭМ ы░Шы│╡ьЬ╝ыбЬ
        }
        if (input == 0x1b) { // ESC эВд (ы░йэЦеэВдьЭШ ьЛЬьЮС ь╜ФыУЬ)
            char next1 = getch(); // ыЛдьЭМ ым╕ьЮР ьЭ╜ъ╕░
            char next2 = getch(); // ъ╖╕ыЛдьЭМ ым╕ьЮР ьЭ╜ъ╕░
            if (next1 == '[') { // ESC [ ... эШХэГЬьЭШ ы░йэЦеэВд ьЮЕыае
                if (next2 == 'A') { input = 'A'; fire_dx = 0; fire_dy = -1; dirX = 0; dirY = -1; } // тЖС (ы░йэЦеэВд ьЮЕыае ьЛЬ ы░ЬьВм ы░йэЦеыПД ьЧЕыН░ьЭ┤эК╕)
                else if (next2 == 'B') { input = 'B'; fire_dx = 0; fire_dy = 1; dirX = 0; dirY = 1; }  // тЖУ
                else if (next2 == 'C') { input = 'C'; fire_dx = 1; fire_dy = 0; dirX = 1; dirY = 0; }  // тЖТ
                else if (next2 == 'D') { input = 'D'; fire_dx = -1; fire_dy = 0; dirX = -1; dirY = 0; } // тЖР
            }
        }
        if (input == '1') { // эХШъ╕Й ым╝ьХ╜ ьВмьЪй
            if (potion1_hp > 0) {
                potion1_hp--;
                playerHP += 10;
                if (playerHP > playerMaxHP) playerHP = playerMaxHP; // ь╡ЬыМА ь▓┤ыае ь┤Иъ│╝ ы░йьзА
                printf("\n ЁЯТЪ эХШъ╕Й эПмьЕШ ьВмьЪй! ь▓┤ыае +10\n");
            } else {
                printf("\nтЭЧ эХШъ╕Й эПмьЕШьЭ┤ ьЧЖьК╡ыЛИыЛд!\n");
            }
            usleep(1000000);
            continue;
        }
        if (input == '2') { // ьдСъ╕Й ым╝ьХ╜ ьВмьЪй
            if (potion2_hp > 0) {
                potion2_hp--;
                playerHP += 30;
                if (playerHP > playerMaxHP) playerHP = playerMaxHP;
                printf("\n ЁЯТЩ ьдСъ╕Й эПмьЕШ ьВмьЪй! ь▓┤ыае +30\n");
            } else {
                printf("\nтЭЧ ьдСъ╕Й эПмьЕШьЭ┤ ьЧЖьК╡ыЛИыЛд!\n");
            }
            usleep(1000000);
            continue;
        }
        if (input == '3') { // ьГБъ╕Й ым╝ьХ╜ ьВмьЪй
            if (potion3_hp > 0) {
                potion3_hp--;
                playerHP += 70;
                if (playerHP > playerMaxHP) playerHP = playerMaxHP;
                printf("\n ЁЯТЦ ьГБъ╕Й эПмьЕШ ьВмьЪй! ь▓┤ыае +70\n");
            } else {
                printf("\nтЭЧ ьГБъ╕Й эПмьЕШьЭ┤ ьЧЖьК╡ыЛИыЛд!\n");
            }
            usleep(1000000);
            continue;
        }
        if (input == 'q' || input == 'Q') { // 'q' ыШРыКФ 'Q' ьЮЕыае ьЛЬ ъ▓МьЮД ьвЕыгМ
            break;
        }
        if (input == 'i' || input == 'I') { // 'i' ыШРыКФ 'I' ьЮЕыае ьЛЬ ьЭ╕ы▓дэЖаыжм ьЧ┤ъ╕░
            while (1) {
                printf("\033[H\033[J"); // эЩФый┤ ьзАьЪ░ъ╕░
                printf("\n-------------------- ьЭ╕ы▓дэЖаыжм эЩХьЭ╕ --------------------\n");
                printf("\n");
                printf("              ЁЯТ░  ъ│иыУЬ: %dG\n", gold);
                printf("              ЁЯТЪ  эХШъ╕Й ь▓┤ыае ым╝ьХ╜[ %dъ░Ь ]\n", potion1_hp);
                printf("                  - ь▓┤ыае эЪМы│╡ыЯЙ + 10 \n\n");
                printf("              ЁЯТЩ  ьдСъ╕Й ь▓┤ыае ым╝ьХ╜[ %dъ░Ь ]\n", potion2_hp);
                printf("                  - ь▓┤ыае эЪМы│╡ыЯЙ + 30 \n\n");
                printf("              ЁЯТЦ  ьГБъ╕Й ь▓┤ыае ым╝ьХ╜[ %dъ░Ь ]\n", potion3_hp);
                printf("                  - ь▓┤ыае эЪМы│╡ыЯЙ + 70 \n\n");
                if (inventory[0] <= 4){ // ьЧмьЭШьг╝ ьб░ъ░БьЭ┤ 4ъ░Ь ьЭ┤эХШьЭ╝ ыХМ
                    printf("              тЬ┤я╕П  ьЧмьЭШьг╝ ьб░ъ░Б : %d ъ░Ь\n", inventory[0]);
                    printf("                  - 4ьб░ъ░БьЭД ыкиьЬ╝ый┤ ьЧмьЭШьг╝ъ░А ыРйыЛИыЛд. \n\n");
                }
                if (inventory[9] == 1)  // ьЧмьЭШьг╝ ьХДьЭ┤эЕЬьЭ┤ ьЭ╕ы▓дэЖаыжмьЧР ьЮИьЬ╝ый┤ ь╢Ьыае
                    printf("              ЁЯПЖ  ьЧмьЭШьг╝\n\n");
                if (hasKey == 1) { // ьЧ┤ьЗаъ░А ьЮИыЛдый┤ ь╢Ьыае
                    printf("              ЁЯЧЭя╕П  эЮИыУа ыНШьаД ьЧ┤ьЗа\n");
                }
                printf("\n");
                printf("-------------------------------------------------------\n");
                printf("\n");
                printf("            ( i ) эВдые╝ ыЛдьЛЬ ыИДые┤ый┤ ыПМьХДъ░СыЛИыЛд...\n");

                char temp = getch(); // ьЭ╕ы▓дэЖаыжм ьвЕыгМые╝ ьЬДэХЬ эВд ьЮЕыае ыМАъ╕░
                if (temp == 'i' || temp == 'I') break; // 'i' ыШРыКФ 'I' ьЮЕыае ьЛЬ ьвЕыгМ
            }
            continue; // ыйФьЭ╕ ъ▓МьЮД ыгиэФД ыЛдьЛЬ ьЛЬьЮС
        }

        int newX = playerX, newY = playerY; // ьГИыбЬьЪ┤ эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш ъ│ДьВ░
        if (input == 'A') newY--; // ьЬДыбЬ ьЭ┤ыПЩ
        else if (input == 'B') newY++; // ьХДыЮШыбЬ ьЭ┤ыПЩ
        else if (input == 'D') newX--; // ьЩ╝ьк╜ьЬ╝ыбЬ ьЭ┤ыПЩ
        else if (input == 'C') newX++; // ьШдые╕ьк╜ьЬ╝ыбЬ ьЭ┤ыПЩ

        // ьГИыбЬьЪ┤ ьЬДь╣Шъ░А ьЬаэЪиэХШъ│а ы▓╜('1')ьЭ┤ыВШ ьЮеьХаым╝('2')ьЭ┤ ьХДыЛИый┤ ьЭ┤ыПЩ эЧИьЪй
        if (newX >= 0 && newX < COL && newY >= 0 && newY < ROW && map[newY][newX] != '1' && map[newY][newX] != '2') {
            // эФМыаИьЭ┤ьЦ┤ьЩА ыкмьКдэД░ ь╢йыПМ ь▓┤эБм (эФМыаИьЭ┤ьЦ┤ъ░А ыкмьКдэД░ ь╣╕ьЬ╝ыбЬ ьЭ┤ыПЩ ьЛЬ ыН░ып╕ьзА)
            bool hit_monster = false;
            for (int m = 0; m < monsterCount; m++) {
                if (monsters[m].alive && monsters[m].x == newX && monsters[m].y == newY) {
                    playerHP -= 10; // ыкмьКдэД░ьЩА ь╢йыПМ ьЛЬ 10 ыН░ып╕ьзА
                    if (playerHP < 0) playerHP = 0;
                    hit_monster = true;
                    break;
                }
            }
            if (!hit_monster) { // ыкмьКдэД░ьЩА ь╢йыПМэХШьзА ьХКьХШыЛдый┤ ьЭ┤ыПЩ
                playerX = newX;
                playerY = newY;
            }
        }

        // ыз╡ ьЭ┤ыПЩ ы░П ьГБэШ╕ьЮСьЪй ь▓Шыжм
        if (map[playerY][playerX] == '3') { // ыНШьаД 1 ьЮЕъ╡м
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ЁЯЯв ыНШьаД 1ьЧР ьЮЕьЮеэХШьЕиьК╡ыЛИыЛд...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000); // 1ь┤И ыМАъ╕░
            memcpy(map, map1, sizeof(map)); // ыз╡ьЭД ыНШьаД 1ыбЬ ы│Аъ▓╜
            playerX = 1; // эФМыаИьЭ┤ьЦ┤ ьЬДь╣Ш ь┤Иъ╕░эЩФ
            playerY = 18;
            currentMapName = "ыНШьаД 1"; // ыз╡ ьЭ┤ыжД ы│Аъ▓╜
            monsterCount = 0; // ыкмьКдэД░ ь┤Иъ╕░эЩФ
            spawnMonster(10, 5, 0);  // ыЛмэМ╜ьЭ┤ ыкмьКдэД░ ьГЭьД▒
            spawnMonster(15, 10, 0);
            spawnMonster(20, 7, 0);
            spawnMonster(25, 12, 0);
            spawnMonster(30, 9, 0);
        } else if (map[playerY][playerX] == '4') { // ыНШьаД 2 ьЮЕъ╡м
            if (!questAccepted[1]) { // эАШьКдэК╕ 2ые╝ ьИШыЭ╜эХШьзА ьХКьХШыЛдый┤
                printf("\nтЭЧ эАШьКдэК╕ 2ые╝ ьИШыЭ╜эХ┤ьХ╝ ыНШьаД 2ьЧР ьЮЕьЮеэХа ьИШ ьЮИьК╡ыЛИыЛд.\n");
                printf("ьХДым┤ эВдыВШ ыИМыЯм ъ│ДьЖН...\n");
                getch();
                continue;
            }

            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ЁЯФ╡ ыНШьаД 2ьЧР ьЮЕьЮеэХШьЕиьК╡ыЛИыЛд...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map2, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ыНШьаД 2";
            monsterCount = 0;
            spawnMonster(10, 5, 1); // ыПДызИы▒А ыкмьКдэД░ ьГЭьД▒
            spawnMonster(15, 10, 1);
            spawnMonster(20, 7, 1);
            spawnMonster(25, 12, 1);
            spawnMonster(30, 9, 1);
        } else if (map[playerY][playerX] == '5') { // ыНШьаД 3 ьЮЕъ╡м
            if (!questAccepted[2]) { // эАШьКдэК╕ 3ьЭД ьИШыЭ╜эХШьзА ьХКьХШыЛдый┤
                printf("\nтЭЧ эАШьКдэК╕ 3ьЭД ьИШыЭ╜эХ┤ьХ╝ ыНШьаД 3ьЧР ьЮЕьЮеэХа ьИШ ьЮИьК╡ыЛИыЛд.\n");
                printf("ьХДым┤ эВдыВШ ыИМыЯм ъ│ДьЖН...\n");
                getch();
                continue;
            }

            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ЁЯФ┤ ыНШьаД 3ьЧР ьЮЕьЮеэХШьЕиьК╡ыЛИыЛд...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map3, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ыНШьаД 3";
            monsterCount = 0;
            spawnMonster(10, 5, 2); // ыПЕъ▒░ып╕ ыкмьКдэД░ ьГЭьД▒
            spawnMonster(15, 10, 2);
            spawnMonster(20, 7, 2);
            spawnMonster(25, 12, 2);
            spawnMonster(30, 9, 2);
        } else if (map[playerY][playerX] == '6') { // эЮИыУа ыНШьаД ьЮЕъ╡м
            if (hasKey) { // ьЧ┤ьЗаъ░А ьЮИыЛдый┤ ьзДьЮЕ ъ░АыКе
                printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
                printf("ЁЯЪк эЮИыУа ыНШьаД 4ьЧР ьЮЕьЮеэХШьЕиьК╡ыЛИыЛд...\n\n");
                printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
                usleep(1000000);
                memcpy(map, map4, sizeof(map));
                playerX = 1;
                playerY = 18;
                currentMapName = "ыНШьаД 4 (эЮИыУа ыз╡)";
                monsterCount = 0;
                spawnMonster(14, 8, 3); // ыУЬыЭ╝эБШыЭ╝ ыкмьКдэД░ ьГЭьД▒
            } else { // ьЧ┤ьЗаъ░А ьЧЖыЛдый┤
                printf("\nтЭЧ ьЧ┤ьЗаъ░А ьЧЖьЦ┤ьДЬ ыУдьЦ┤ъ░И ьИШ ьЧЖьК╡ыЛИыЛд...\n");
                printf("ьХДым┤ эВдыВШ ыИДые┤ый┤ ъ│ДьЖНэХйыЛИыЛд...\n");
                getch();
            }
        } else if (map[playerY][playerX] == '7') { // ы│┤ьКд ыНШьаД ьЮЕъ╡м
            if (!questAccepted[4]) { // ь╡ЬьвЕ эАШьКдэК╕ые╝ ьИШыЭ╜эХШьзА ьХКьХШыЛдый┤
                printf("\nтЭЧ ь╡ЬьвЕ эАШьКдэК╕ые╝ ьИШыЭ╜эХ┤ьХ╝ ь╡ЬьвЕ ыНШьаДьЧР ьЮЕьЮеэХа ьИШ ьЮИьК╡ыЛИыЛд.\n");
                printf("ьХДым┤ эВдыВШ ыИМыЯм ъ│ДьЖН...\n");
                getch();
                continue;
            }

            // ыНШьаД 5 ьЮЕьЮе ьаД ыйФьЛЬьзА
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("тЪл ь╡ЬьвЕ ыНШьаД 5ьЧР ьЮЕьЮеэХШьЕиьК╡ыЛИыЛд...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000); // 1ь┤И ыМАъ╕░

                        
            // ьЧмьЭШьг╝ ъ┤Аыаи ьХДьЭ┤эЕЬ ъ╡РэЩШ ы░П ыМАэЩФ (ьЭ┤ ы╢Аы╢ДьЭА эФМыаИьЭ┤ьЦ┤ъ░А ы│┤ьКд ыНШьаД ьЮЕьЮе ьЛЬ ьб░ъ▒┤ьЧР ыФ░ыЭ╝ ьКдэЖаыжм эК╕ыжмъ▒░)
            if (inventory[0] >= 4) { // ьЧмьЭШьг╝ ьб░ъ░БьЭ┤ 4ъ░Ь ьЭ┤ьГБьЭ┤ыЭ╝ый┤
                if (a < 30) { // aъ░А 30 ып╕ызМьЭ╝ ыХМ (ьКдэЖаыжм ып╕ы░ЬыПЩ ьГБэГЬ)
                    a = 1; // ьКдэЖаыжм эК╕ыжмъ▒░ ы│АьИШ ьДдьаХ (ьдСъ░Д ьКдэЖаыжм ьЮмьГЭ)
                }
                
            }

            // ыНШьаД 5ыбЬ ыз╡ ы│Аъ▓╜ (ы│┤ьКдьаД ьЛЬьЮС)
            memcpy(map, map5, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ыНШьаД 5 (ь╡ЬьвЕ ы│┤ьКд)";
            monsterCount = 0;

            // ыкмьКдэД░ ьГЭьД▒ ы░П ь╢Фъ░А
            spawnMonster(10, 5, 4);  // эШ╝эЕМьЭ╝ (ы│┤ьКд) ыкмьКдэД░ ьГЭьД▒

        } else if (map[playerY][playerX] == '9') { // ызИьЭД ъ╖АэЩШ ьзАьаР
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ЁЯПб ызИьЭДыбЬ ыПМьХДьЩФьК╡ыЛИыЛд...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map_backup, sizeof(map)); // ыз╡ьЭД ы░▒ьЧЕыРЬ ызИьЭД ыз╡ьЬ╝ыбЬ ы│╡ъ╡м
            playerX = 1;
            playerY = 18;
            currentMapName = "ызИьЭД";
            monsterCount = 0; // ыкмьКдэД░ ь┤Иъ╕░эЩФ
            playerHP = playerMaxHP;  // ЁЯй║ ызИьЭД ы│╡ъ╖А ьЛЬ ь▓┤ыае ьаДы╢А эЪМы│╡
        } else if (map[playerY][playerX] == 'c') { // ь╣┤ьзАыЕ╕ ьЮЕъ╡м (NPCь▓ШыЯ╝ ъ░Аъ╣МьЭ┤ ъ░АьХ╝ ьГБэШ╕ьЮСьЪй)
            int nearCasino = 0; // ь╣┤ьзАыЕ╕ ъ╖╝ь▓ШьЧР ьЮИыКФьзА эЩХьЭ╕ эФМыЮШъ╖╕
            for (int dy = -1; dy <= 1 && !nearCasino; dy++) { // эФМыаИьЭ┤ьЦ┤ ьг╝ы│А 3x3 ь╣╕ эЩХьЭ╕
                for (int dx = -1; dx <= 1 && !nearCasino; dx++) {
                    int ny = playerY + dy;
                    int nx = playerX + dx;
                    if (ny >= 0 && ny < ROW && nx >= 0 && nx < COL && map[ny][nx] == 'c') {
                        nearCasino = 1; // ь╣┤ьзАыЕ╕ ъ╖╝ь▓ШьЧР ьЮИьЭМ
                    }
                }
            }
            if (nearCasino) { // ь╣┤ьзАыЕ╕ ъ╖╝ь▓ШыЭ╝ый┤
                printf("\nЁЯХМ ь╣┤ьзАыЕ╕ьЧР ыПДь░йэЦИьК╡ыЛИыЛд.\n");
                printf("ъ▓МьЮДьЭД ьЛЬьЮСэХШьЛЬъ▓аьК╡ыЛИъ╣М? (Y/N): ");
                fflush(stdout);
                char choice;
                while (1) { // Y/N ьЮЕыае ыМАъ╕░
                    choice = getch();
                    if (choice == 'y' || choice == 'Y') {
                        printf("\nь╣┤ьзАыЕ╕ ъ▓МьЮДьЭД ьЛЬьЮСэХйыЛИыЛд...\n");
                        usleep(1000000);
                        playCasino(&gold); // ь╣┤ьзАыЕ╕ ъ▓МьЮД ьЛЬьЮС
                        break;
                    } else if (choice == 'n' || choice == 'N') {
                        printf("\nь╣┤ьзАыЕ╕ ьЮЕьЮеьЭД ь╖иьЖМэЦИьК╡ыЛИыЛд.\n");
                        usleep(1000000);
                        break;
                    } 
                }
                // ь╣┤ьзАыЕ╕ ьГБэШ╕ьЮСьЪй эЫД эФМыаИьЭ┤ьЦ┤ ьЬДь╣Шые╝ ь╣┤ьзАыЕ╕ ьЮЕъ╡м ьШЖьЬ╝ыбЬ ьЭ┤ыПЩьЛЬэВдыКФ ыбЬьзБ (ъ▓╣ь╣ШьзА ьХКъ▓М)
                if (map[playerY][playerX + 1] == '0') playerX++;
                else if (map[playerY][playerX - 1] == '0') playerX--;
                else if (map[playerY - 1][playerX] == '0') playerY--;
                else if (map[playerY + 1][playerX] == '0') playerY++;
            }

        } else if (map[playerY][playerX] == 'z') { // ым╝ьХ╜ ьГБьаР ьЮЕъ╡м (ъ░Аъ╣МьЭ┤ ъ░Аый┤ ьГБэШ╕ьЮСьЪй)
            printf("\nЁЯПе ым╝ьХ╜ьГБьаРьЧР ыПДь░йэЦИьК╡ыЛИыЛд. \n");
            openPotionShop(&gold, &potion1_hp, &potion2_hp, &potion3_hp); // ым╝ьХ╜ ьГБьаР ьЧ┤ъ╕░
            // ым╝ьХ╜ ьГБьаР ьГБэШ╕ьЮСьЪй эЫД эФМыаИьЭ┤ьЦ┤ ьЬДь╣Шые╝ ьГБьаР ьЮЕъ╡м ьШЖьЬ╝ыбЬ ьЭ┤ыПЩьЛЬэВдыКФ ыбЬьзБ
            if (map[playerY][playerX + 1] == '0') playerX++;
            else if (map[playerY][playerX - 1] == '0') playerX--;
            else if (map[playerY - 1][playerX] == '0') playerY--;
            else if (map[playerY + 1][playerX] == '0') playerY++;
            
            
        } else if (map[playerY][playerX] == 'n') { // NPCьЩА ьГБэШ╕ьЮСьЪй
            // эАШьКдэК╕ 1 ьЩДыгМ ьб░ъ▒┤ эЩХьЭ╕ ы░П ы│┤ьГБ ьзАъ╕Й
            if (questAccepted[0] && !questCompleted[0] &&
                questKillCount[0] >= 10 && questItemCount[0] >= 5) {
                questCompleted[0] = 1; // эАШьКдэК╕ ьЩДыгМ ь▓Шыжм
                rewardGiven[0] = 1; // ы│┤ьГБ ьзАъ╕Й эФМыЮШъ╖╕ ьДдьаХ
                gold += 100; // ъ│иыУЬ ьзАъ╕Й
                inventory[0] += 1; // ьЧмьЭШьг╝ ьб░ъ░Б ьзАъ╕Й
                printf("\nЁЯдЦ NPC: тАЬэЫМыенэХШыДд. ыЛмэМ╜ьЭ┤ ь▓Шь╣ШьЩА ыУ▒ъ╗НьзИ ьИШьзСьЭД ыкиыСР эХ┤ыГИъ╡░.тАЭ\n");
                printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +100, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
                usleep(1500000);
                playerX = npcX + 1;  // NPC ьШдые╕ьк╜ьЬ╝ыбЬ ъ░ХьаЬ ьЭ┤ыПЩ
                playerY = npcY;
                continue; // ыЛдые╕ ыМАьВмьЩА ъ▓╣ь╣ШьзА ьХКыПДыбЭ
            }
            // эАШьКдэК╕ 2 ьЩДыгМ ьб░ъ▒┤ эЩХьЭ╕ ы░П ы│┤ьГБ ьзАъ╕Й
            if (questAccepted[1] && !questCompleted[1] &&
                questKillCount[1] >= 10 && questItemCount[1] >= 5) {
                questCompleted[1] = 1;
                rewardGiven[1] = 1;
                gold += 200;
                inventory[0] += 1;
                printf("\nЁЯдЦ NPC: тАЬыПДызИы▒Аъ╣МьзА эХ┤ь╣ШьЪ░ыЛдыЛИ! ьЛдыае ьЭ╕ьаХэХШыДд.тАЭ\n");
                printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +200, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
                usleep(1500000);
                playerX = npcX + 1;
                playerY = npcY;
                continue;
            }

            // эАШьКдэК╕ 3 ьЩДыгМ ьб░ъ▒┤ эЩХьЭ╕ ы░П ы│┤ьГБ ьзАъ╕Й
            if (questAccepted[2] && !questCompleted[2] &&
                questKillCount[2] >= 10 && questItemCount[2] >= 5) {
                questCompleted[2] = 1;
                rewardGiven[2] = 1;
                gold += 300;
                inventory[0] += 1;
                printf("\nЁЯдЦ NPC: тАЬыз╣ыПЕ ъ▒░ып╕ыПД ь▓Шь╣ШэХШыЛдыЛИ, ьЭ┤ьаа ьзДьзЬ ьЪйьВм ъ░Щъ╡░.тАЭ\n");
                printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +300, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
                usleep(1500000);
                playerX = npcX + 1;
                playerY = npcY;
                continue;
            }

            // эАШьКдэК╕ 4 ьЩДыгМ ьб░ъ▒┤ эЩХьЭ╕ ы░П ы│┤ьГБ ьзАъ╕Й
            if (questAccepted[3] && !questCompleted[3] &&
                questKillCount[3] >= 1 && questItemCount[3] >= 1) {
                questCompleted[3] = 1;
                rewardGiven[3] = 1;
                gold += 500;
                inventory[0] += 1;
                printf("\nЁЯдЦ NPC: тАЬыУЬыЭ╝эБШыЭ╝ьЭШ ьЛмьЮеьЭД ьЦ╗ьЧИыЛдыЛИ... ыМАыЛиэХШъ╡░.тАЭ\n");
                printf("ЁЯТ░ ы│┤ьГБ: ъ│иыУЬ +500, ьЧмьЭШьг╝ ьб░ъ░Б +1\n");
                usleep(1500000);
                playerX = npcX + 1;
                playerY = npcY;
                continue;
            }

            // эАШьКдэК╕ 5 ьЩДыгМ ьб░ъ▒┤ эЩХьЭ╕ ы░П ы│┤ьГБ ьзАъ╕Й
            if (questAccepted[4] && !questCompleted[4] &&
                questKillCount[4] >= 1 && questItemCount[4] >= 1) {
                questCompleted[4] = 1;
                rewardGiven[4] = 1;
                gold += 1000;
                inventory[4] += 1; // ьЭ╕ы▓дэЖаыжмьЭШ 4ы▓И ьЭ╕ыН▒ьКдьЧР ьХДьЭ┤эЕЬ ь╢Фъ░А (эШ╝эЕМьЭ╝ ьаХьИШ)
                printf("\nЁЯдЦ NPC: тАЬэШ╝эЕМьЭ╝ьЭД ьУ░ыЯмыЬиыжмыЛдыЛИтАж ы│╡ьИШыКФ ьЩДьД▒ыРШьЧИыПДыЛд.тАЭ\n");
                printf("ЁЯОЙ ь╡ЬьвЕ ы│┤ьГБ: ъ│иыУЬ +1000, эШ╝эЕМьЭ╝ьЭШ ьаХьИШ +1\n");
                usleep(2000000);
                playerX = npcX + 1;
                playerY = npcY;
                continue;
            }
            // эАШьКдэК╕ ыйШэК╕ ы░П ьИШыЭ╜ ьЧмы╢А (ьИЬьДЬыМАыбЬ эАШьКдэК╕ые╝ ьаЬъ│╡)
            if (!questAccepted[0]) { // эАШьКдэК╕ 1ьЭД ьИШыЭ╜эХШьзА ьХКьХШыЛдый┤
                printf("\nЁЯдЦ NPC: тАЬъ│дтАж ы│╡ьИШые╝ ьЬДэХ┤ьДа ыи╝ьаА ык╕ы╢АэД░ ыЛиыаиэХ┤ьХ╝ эХ┤. ьаА ьХЮ ьИ▓ьЧР ыЛмэМ╜ьЭ┤ ым┤ыжмыУдьЭ┤ ыВШэГАыВмыЛдъ│а эХШыНФъ╡░.\n");
                printf("          ыи╝ьаА ъ╖╕ ыЕАьДЭыУды╢АэД░ ь▓Шь╣ШэХШъ│а, ыЛмэМ╜ьЭ┤ ыУ▒ъ╗НьзИьЭД ыкиьХДьЩА ьдШ.тАЭ\n");
                printf("          тАЬыЛмэМ╜ьЭ┤ъ░А ьЮИыКФ ьИ▓ьЭА ЁЯЯв ьЭ┤ыЭ╝ыДдтАЭ\n");
                printf("\nЁЯУЬ эАШьКдэК╕ые╝ ьИШыЭ╜эХШьЛЬъ▓аьК╡ыЛИъ╣М? (Y/N): ");
                fflush(stdout);

                char q;
                while (1) { // Y/N ьЮЕыае ыМАъ╕░
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[0] = 1; // эАШьКдэК╕ 1 ьИШыЭ╜
                        printf("\nтЬЕ эАШьКдэК╕ 1 [ыЛмэМ╜ьЭ┤ые╝ ьг╜ьЧмыЭ╝]ые╝ ьИШыЭ╜эЦИьК╡ыЛИыЛд!\n");
                        usleep(1500000);
                        playerX = npcX + 1;  // NPC ьШдые╕ьк╜ьЬ╝ыбЬ ъ░ХьаЬ ьЭ┤ыПЩ
                        playerY = npcY;
                        break;
                    } else if (q == 'n' || q == 'N') {
                        printf("\nтЭЧ эАШьКдэК╕ ьИШыЭ╜ьЭД ь╖иьЖМэЦИьК╡ыЛИыЛд.\n");
                        usleep(1000000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                    }
                }
            } else if (questAccepted[0] && questCompleted[0] && !questAccepted[1]) { // эАШьКдэК╕ 1 ьЩДыгМ эЫД эАШьКдэК╕ 2 ып╕ьИШыЭ╜ ьЛЬ
                printf("\nЁЯдЦ NPC: тАЬыЛмэМ╜ьЭ┤ ыФ░ьЬДыбЬыКФ ы│╡ьИШые╝ эХа ьИШ ьЧЖьЦ┤. ьвА ыНФ ъ░ХэХЬ ьаБьЭД ьГБыМАэХ┤ьХ╝ьзА.\n");
                printf("          ьИ▓ ьЖН ъ╣КьЭА ъ││ьЧР ьИ▓ ыПДызИы▒АьЭ┤ ь╢Ьык░эХЬыЛдъ│а эХШыНФъ╡░.тАЭ\n");
                printf("          тАЬыПДызИы▒АьЭ┤ ь╢Ьык░эХШыКФ ьИ▓ьЭА ЁЯФ╡ ьЭ┤ыЭ╝ыДдтАЭ\n");
                printf("\nЁЯУЬ эАШьКдэК╕ 2 [ьИ▓ ыПДызИы▒АьЭД ьг╜ьЧмыЭ╝]ые╝ ьИШыЭ╜эХШьЛЬъ▓аьК╡ыЛИъ╣М? (Y/N): ");
                fflush(stdout);

                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[1] = 1;
                        printf("\nтЬЕ эАШьКдэК╕ 2 [ьИ▓ ыПДызИы▒АьЭД ьг╜ьЧмыЭ╝]ые╝ ьИШыЭ╜эЦИьК╡ыЛИыЛд!\n");
                        usleep(1500000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nтЭЧ эАШьКдэК╕ ьИШыЭ╜ьЭД ь╖иьЖМэЦИьК╡ыЛИыЛд.\n");
                        usleep(1000000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                    }
                }
            } else if (questAccepted[1] && questCompleted[1] && !questAccepted[2]) { // эАШьКдэК╕ 2 ьЩДыгМ эЫД эАШьКдэК╕ 3 ып╕ьИШыЭ╜ ьЛЬ
                printf("\nЁЯдЦ NPC: тАЬъ╖╕ыМА, ыПЕъ▒░ып╕ьЭШ ыз╣ыПЕыПД ъ░РыЛ╣эХа ьИШ ьЮИьЭДъ╣М? ыНШьаД 3ьЧРьДЬ ъ╕░ыЛдыжмъ│а ьЮИьЭД ъ▒╕ьД╕.тАЭ\n");
                printf("          тАЬыПЕъ▒░ып╕ьЭШ ыНШьаДьЭА ЁЯФ┤ ьЭ┤ыЭ╝ыДдтАЭ\n");
                printf("\nЁЯУЬ эАШьКдэК╕ 3 [ыз╣ыПЕ ъ▒░ып╕ые╝ ь▓Шь╣ШэХШыЭ╝]ые╝ ьИШыЭ╜эХШьЛЬъ▓аьК╡ыЛИъ╣М? (Y/N): ");
                fflush(stdout);
                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[2] = 1;
                        printf("\nтЬЕ эАШьКдэК╕ 3 [ыз╣ыПЕ ъ▒░ып╕ые╝ ь▓Шь╣ШэХШыЭ╝]ые╝ ьИШыЭ╜эЦИьК╡ыЛИыЛд!\n");
                        usleep(1500000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nтЭЧ эАШьКдэК╕ ьИШыЭ╜ьЭД ь╖иьЖМэЦИьК╡ыЛИыЛд.\n");
                        usleep(1000000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    }
                }
            } else if (questAccepted[2] && questCompleted[2] && !questAccepted[3]) { // эАШьКдэК╕ 3 ьЩДыгМ эЫД эАШьКдэК╕ 4 ып╕ьИШыЭ╜ ьЛЬ
                printf("\nЁЯдЦ NPC: тАЬэЭбэШИьЭШ ьЩХ, ыУЬыЭ╝эБШыЭ╝ъ░А ъ╖╕ыМАые╝ ъ╕░ыЛдыжмъ│а ьЮИыЛд.тАЭ\n");
                printf("          тАЬыПЕъ▒░ып╕ьЭШ ыНШьаДьЬ╝ыбЬ ыУдьЦ┤ъ░А ЁЯЪк ым╕ьЭД ьЧ┤ый┤ ыУЬыЭ╝эБШыЭ╝ъ░А ьЮИыЛдыДдтАЭ\n");
                printf("\nЁЯУЬ эАШьКдэК╕ 4 [ыУЬыЭ╝эБШыЭ╝ые╝ ь▓Шь╣ШэХШыЭ╝]ые╝ ьИШыЭ╜эХШьЛЬъ▓аьК╡ыЛИъ╣М? (Y/N): ");
                fflush(stdout);
                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[3] = 1;
                        printf("\nтЬЕ эАШьКдэК╕ 4 [ыУЬыЭ╝эБШыЭ╝ые╝ ь▓Шь╣ШэХШыЭ╝]ые╝ ьИШыЭ╜эЦИьК╡ыЛИыЛд!\n");
                        usleep(1500000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nтЭЧ эАШьКдэК╕ ьИШыЭ╜ьЭД ь╖иьЖМэЦИьК╡ыЛИыЛд.\n");
                        usleep(1000000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    }
                }
            } else if (questAccepted[3] && questCompleted[3] && !questAccepted[4]) { // эАШьКдэК╕ 4 ьЩДыгМ эЫД эАШьКдэК╕ 5 ып╕ьИШыЭ╜ ьЛЬ
                printf("\nЁЯдЦ NPC: тАЬь╡ЬьвЕ ы│┤ьКдтАж эШ╝эЕМьЭ╝ьЭД ьГБыМАэХа ьдАы╣Дъ░А ыРШьЧИыКФъ░А?тАЭ\n");
                printf("\nЁЯУЬ эАШьКдэК╕ 5 [эШ╝эЕМьЭ╝ьЭД ьУ░ыЯмыЬиыадыЭ╝]ые╝ ьИШыЭ╜эХШьЛЬъ▓аьК╡ыЛИъ╣М? (Y/N): ");
                fflush(stdout);
                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[4] = 1;
                        printf("\nтЬЕ эАШьКдэК╕ 5 [эШ╝эЕМьЭ╝ьЭД ьУ░ыЯмыЬиыадыЭ╝]ые╝ ьИШыЭ╜эЦИьК╡ыЛИыЛд!\n");
                        usleep(1500000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nтЭЧ эАШьКдэК╕ ьИШыЭ╜ьЭД ь╖иьЖМэЦИьК╡ыЛИыЛд.\n");
                        usleep(1000000);
                        playerX = npcX + 1;
                        playerY = npcY;
                        break;
                        
                    }
                }
            } else if (questAccepted[4] && questCompleted[4]) { // ыкиыУа эАШьКдэК╕ ьЩДыгМ ьЛЬ (ьЧФыФй ьКдэЖаыжм)
                printf("\nЁЯдЦ NPC: тАЬъ╖╕ыМАыКФ ыкиыУа ы│╡ьИШые╝ ьЩДьИШэЦИыПДыЛд. ьзДьаХэХЬ ьЪйьВмьЧм.тАЭ\n");
                usleep(2000000);
                    // --- ьЧФыФй ьКдэЖаыжм ыН░ьЭ┤эД░ ---
                const char** ending_arts[] = { // ьЧФыФй ьКдэЖаыжм ьВ╜эЩФ ы░░ьЧ┤
                    dragonFight, dragonFight, NULL, NULL, NULL, dragon, dragon, NULL
                };
                const int ending_art_lines[] = { // ъ░Б ьВ╜эЩФьЭШ ыЭ╝ьЭ╕ ьИШ ы░░ьЧ┤
                    sizeof(dragonFight)/sizeof(dragonFight[0]), sizeof(dragonFight)/sizeof(dragonFight[0]), 0, 0, 0,
                    sizeof(dragon)/sizeof(dragon[0]), sizeof(dragon)/sizeof(dragon[0]), 0
                };
                const char* ending_texts[] = { // ьЧФыФй ьКдэЖаыжм ыМАьВм
                    "ъ│дъ│╝ эШ╝эЕМьЭ╝ьЭШ ызИьзАызЙ ъ▓░ьаДьЭА ь▓ЬыСеь▓ШыЯ╝ ьЪ╕ыад эН╝ьбМыЛд.",
                    "ь╣ШьЧ┤эХЬ ьЛ╕ьЫА ыБЭьЧР, ызИь╣иыВ┤ ъ│дьЭА эШ╝эЕМьЭ╝ьЭШ ьИиэЖ╡ьЭД ыБКьЧИыЛд.",
                    "ьУ░ыЯмьзД эШ╝эЕМьЭ╝ьЭШ ык╕ьЧРьДЬ ьЦ┤ыСаьЭ┤ ъ▒╖эЮИъ│а, ь▓Ьъ│╡ьЭШ ыСеьзАьЧРыКФ ыЛдьЛЬ эПЙэЩФъ░А ь░╛ьХДьЩФыЛд.",
                    "ъ│дьЭА ь▓Ьь▓ЬэЮИ ы░Ьъ▒╕ьЭМьЭД ьШоъ▓и, ыкиыУа ъ▓ГьЭ┤ эММъ┤┤ыРЬ ь▓Ьъ│╡ьЭШ ыСеьзАыбЬ ыПМьХДъ░ФыЛд.",
                    "ьШИьаДьЭШ ыФ░ыЬ╗эХиъ│╝ ьГЭыкЕьЭ┤ ъ░АыУЭэЦИыНШ ъ╖╕ъ││ьЭА ьЭ┤ьаЬ ьХДым┤ъ▓ГыПД ыВиьзА ьХКьЭА эЕЕ ы╣И ъ│╡ъ░ДьЭ┤ ыРШьЦ┤ ьЮИьЧИыЛд.",
                    "ъ╖╕ыЯмыВШ ъ│дьЭА ьХМьХШыЛд. ъ╖╕ъ││ьЧР ыЛ┤ъ╕┤ ъ╕░ьЦ╡ъ│╝ ьЮРьЛаьЭ┤ ьзАь╝ЬыВ╕ эПЙэЩФъ░А ьГИыбЬьЪ┤ ьЛЬьЮСьЭД ьЬДэХЬ эЭмызЭьЮДьЭД.",
                    "ьШдыЮлыПЩьХИ ъ░АьК┤ьЖНьЧР ыз║эШФыНШ ы│╡ьИШьЭШ ым┤ъ▒░ьЪ┤ ьзРьЭ┤ ьВмыЭ╝ьзАъ│а, ъ│дьЭШ ыИИъ░АьЧРыКФ ьХДэФИ ъ╕░ьЦ╡ъ│╝ ьГИыбЬьЪ┤ ыВ┤ьЭ╝ьЧР ыМАэХЬ ыЛдьзРьЭ┤ эХиъ╗Ш ыз║эШФыЛд.",
                    "ъ╖╕ыжмэХШьЧм ьЦ┤ыж░ ыУЬыЮШъ│д ъ│дьЭШ ьЧмьаХьЭА ызИь╣иыВ┤ ыБЭьЭ┤ ыВмъ│а, ъ╖╕ьЭШ ызИьЭМьЖНьЧР ьГИыбнъ▓М эФ╝ьЦ┤ыВЬ эПЙэЩФъ░А эХШыКШ ыЖТьЭ┤ эН╝ьа╕ыВШъ░ФыЛд.",
                };
                int ending_frameCount = sizeof(ending_texts) / sizeof(ending_texts[0]); // ьЧФыФй ьКдэЖаыжм эФДыаИьЮД ъ░ЬьИШ
                
                printf("\033[2J\033[1;1H"); // эЩФый┤ ьзАьЪ░ъ╕░
                sleep(1);
                playStory(ending_arts, ending_art_lines, ending_texts, ending_frameCount); // ьЧФыФй ьКдэЖаыжм ьЮмьГЭ
                
                printf("\033[2J\033[1;1H"); // эЩФый┤ ьзАьЪ░ъ╕░
                break; // ыйФьЭ╕ ъ▓МьЮД ыгиэФД ьвЕыгМ (ъ▓МьЮД ьвЕыгМ)
            } else { // эШДьЮм ьИШэЦЙэХа ьИШ ьЮИыКФ эАШьКдэК╕ъ░А ьЧЖьЭД ыХМ
                printf("\nЁЯдЦ NPC: эШДьЮм ьИШэЦЙэХа ьИШ ьЮИыКФ эАШьКдэК╕ъ░А ьЧЖьК╡ыЛИыЛд.\n");
                usleep(1000000);
            }
        }

        updateFireballs(map, &playerHP, &playerMaxHP, playerX, playerY); // эММьЭ┤ьЦ┤ы│╝ ьЧЕыН░ьЭ┤эК╕
        updateMonsters(playerX, playerY, map); // ыкмьКдэД░ ьЧЕыН░ьЭ┤эК╕
        usleep(30000); // 30ms ыМАъ╕░ (ь┤ИыЛ╣ ьХ╜ 33эФДыаИьЮД)
    }

    disableRawMode(); // эД░ып╕ыДР ьЫРьЛЬ ыкиыУЬ ы╣ДэЩЬьД▒эЩФ
    tcsetattr(STDIN_FILENO, TCSANOW, &orig_termios); // эД░ып╕ыДР ьДдьаХьЭД ьЫРыЮШыМАыбЬ ы│╡ъ╡м
    printf("\nъ▓МьЮДьЭД ьвЕыгМэХйыЛИыЛд. \n");
    return 0; // эФДыбЬъ╖╕ыЮи ьвЕыгМ
}